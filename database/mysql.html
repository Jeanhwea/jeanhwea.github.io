<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-07-02 Fri 23:34 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MySQL 关系数据库</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Jinghui Hu" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="styles/readtheorg/css/readtheorg.css"/>
<script type="text/javascript" src="styles/lib/js/jquery.min.js"></script>
<script type="text/javascript" src="styles/lib/js/bootstrap.min.js"></script>
<script type="text/javascript" src="styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="styles/readtheorg/js/readtheorg.js"></script>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="../readme.html"> UP </a>
 |
 <a accesskey="H" href="../index.html"> HOME </a>
</div><div id="content">
<h1 class="title">MySQL 关系数据库</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orga99b70b">1. 简介</a>
<ul>
<li><a href="#orgf1f2c72">1.1. 安装 MySQL</a>
<ul>
<li><a href="#orgfd2f59f">1.1.1. Mac</a></li>
<li><a href="#org8938e4f">1.1.2. Windows</a></li>
<li><a href="#orgf1059b1">1.1.3. Unix</a></li>
<li><a href="#org9f06aa3">1.1.4. Docker</a></li>
</ul>
</li>
<li><a href="#orgc68cdac">1.2. 参考手册</a></li>
<li><a href="#orge18add8">1.3. 帮助系统 - <code>\h</code> 命令</a></li>
</ul>
</li>
<li><a href="#org5e24828">2. 数据库操作</a>
<ul>
<li><a href="#org5f42a50">2.1. 查看数据库基本信息</a></li>
<li><a href="#org73b4f7d">2.2. 查看数据库中所有的表</a></li>
<li><a href="#orgf717af1">2.3. 创建/删除数据库</a></li>
<li><a href="#org4661a52">2.4. 字符编码和校对集</a></li>
</ul>
</li>
<li><a href="#orge048c49">3. 表操作</a>
<ul>
<li><a href="#org5ab7af7">3.1. 创建表</a>
<ul>
<li><a href="#org1fa9e49">3.1.1. 数据类型</a></li>
<li><a href="#org2110214">3.1.2. 列约束</a></li>
</ul>
</li>
<li><a href="#orge476511">3.2. 查看表结构</a></li>
<li><a href="#org97c4d45">3.3. 修改表结构</a></li>
<li><a href="#org22d0e95">3.4. 删除/清空表</a></li>
<li><a href="#org704b159">3.5. 复制表</a></li>
<li><a href="#org25313f9">3.6. 优化表</a></li>
</ul>
</li>
<li><a href="#orgba2cae4">4. 数据操作：增删改查</a>
<ul>
<li><a href="#org4162324">4.1. 插入数据</a></li>
<li><a href="#org7c976c7">4.2. 删除数据</a></li>
<li><a href="#orgb085d75">4.3. 更新数据</a></li>
<li><a href="#org0aff3c8">4.4. 查询数据</a></li>
</ul>
</li>
<li><a href="#orgd374759">5. 高级查询</a>
<ul>
<li><a href="#org34d47da">5.1. 合并多个查询结果 <code>UNION</code></a></li>
<li><a href="#org139fb8a">5.2. 子查询</a>
<ul>
<li><a href="#org87a4c34">5.2.1. FROM 型子查询</a></li>
<li><a href="#orgd1719ef">5.2.2. WHERE 型子查询</a></li>
</ul>
</li>
<li><a href="#org75cad2b">5.3. 联表查询</a>
<ul>
<li><a href="#org1ba22fd">5.3.1. 内连接 INNER JOIN</a></li>
<li><a href="#org22adb90">5.3.2. 外连接 OUTER JOIN</a></li>
<li><a href="#orge03033b">5.3.3. 自然连接 NATURAL JOIN</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org43694d2">6. 视图</a>
<ul>
<li><a href="#org5fcd524">6.1. 创建视图</a></li>
<li><a href="#org44f5284">6.2. 查看结构</a></li>
<li><a href="#org0a4ff44">6.3. 删除视图</a></li>
<li><a href="#org8c1a35f">6.4. 修改视图结构</a></li>
</ul>
</li>
<li><a href="#org1c3fcb0">7. 事务</a>
<ul>
<li><a href="#org25f9123">7.1. 事务的特性 (ACID)</a></li>
<li><a href="#org41e2ee2">7.2. 事务的实现</a></li>
<li><a href="#org267508c">7.3. 事务的原理</a></li>
<li><a href="#orgdfa3883">7.4. 事务开始：开启</a></li>
<li><a href="#org081e7b2">7.5. 事务结束：提交和回滚</a></li>
<li><a href="#org613a9af">7.6. 事务保存：保存点</a></li>
<li><a href="#org7b88b7d">7.7. InnoDB 自动提交特性设置</a></li>
</ul>
</li>
<li><a href="#org9cc4326">8. 锁表</a></li>
<li><a href="#orgb3b2a48">9. 触发器</a>
<ul>
<li><a href="#org73faecc">9.1. 创建触发器</a></li>
<li><a href="#org17b2bed">9.2. 删除触发器</a></li>
<li><a href="#orgbb4e1b0">9.3. 特殊的执行注意项</a></li>
</ul>
</li>
<li><a href="#orga217444">10. SQL 编程</a>
<ul>
<li><a href="#org82848d0">10.1. 变量</a>
<ul>
<li><a href="#orgf49eecf">10.1.1. 变量声明</a></li>
<li><a href="#orge589700">10.1.2. 全局变量</a></li>
<li><a href="#orgecaa748">10.1.3. 自定义变量名</a></li>
</ul>
</li>
<li><a href="#org7f7fd87">10.2. 控制流</a>
<ul>
<li><a href="#orgbd297a9">10.2.1. 分支语句</a></li>
<li><a href="#org1ef5669">10.2.2. 循环语句</a></li>
<li><a href="#org361acff">10.2.3. 语句块包裹</a></li>
</ul>
</li>
<li><a href="#org5a6a729">10.3. 存储函数和存储过程</a>
<ul>
<li><a href="#orgde2733d">10.3.1. 存储函数</a></li>
<li><a href="#org8aeed07">10.3.2. 存储过程</a></li>
</ul>
</li>
<li><a href="#org0e2d17a">10.4. 修改语句的分隔符</a></li>
</ul>
</li>
<li><a href="#org60d323c">11. 用户及权限管理</a>
<ul>
<li><a href="#org333044e">11.1. 用户表</a></li>
<li><a href="#orgf910cbb">11.2. 增加用户</a></li>
<li><a href="#org9f3bed9">11.3. 重命名用户</a></li>
<li><a href="#orgefe769f">11.4. 设置密码</a></li>
<li><a href="#orgf749416">11.5. 删除用户</a></li>
<li><a href="#orgd234e89">11.6. 分配权限/添加用户</a></li>
<li><a href="#org748e6a9">11.7. 查看权限</a></li>
<li><a href="#org8663c2c">11.8. 撤消权限</a></li>
<li><a href="#org24ff696">11.9. 权限层级</a></li>
<li><a href="#orgee73f5d">11.10. 权限列表</a></li>
</ul>
</li>
<li><a href="#orgf48a3da">12. 表维护</a>
<ul>
<li><a href="#org26bdd3c">12.1. 分析和存储表的关键字分布</a></li>
<li><a href="#org7782bae">12.2. 检查一个或多个表是否有错误</a></li>
<li><a href="#orge9e89fe">12.3. 整理数据文件的碎片</a></li>
</ul>
</li>
<li><a href="#org505188c">13. 导入/导出数据</a>
<ul>
<li><a href="#org8772405">13.1. Select 方法导入/导出 CSV 文件</a></li>
<li><a href="#org75bdb31">13.2. 使用 mysqldump 工具</a>
<ul>
<li><a href="#org1cf8e1e">13.2.1. 备份数据</a></li>
<li><a href="#orge157e5a">13.2.2. 导入数据</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgc9e1d4a">14. 内置函数</a>
<ul>
<li><a href="#orgbdc707b">14.1. 数值函数</a></li>
<li><a href="#org54b191c">14.2. 时间日期函数</a></li>
<li><a href="#orgea21617">14.3. 字符串函数</a></li>
<li><a href="#orgbd9263c">14.4. 流程函数</a></li>
<li><a href="#orgfe4cb2f">14.5. 聚合函数</a></li>
<li><a href="#org6b08807">14.6. 其他常用函数</a></li>
</ul>
</li>
<li><a href="#org5ef51c4">15. 常见问题</a>
<ul>
<li><a href="#orga390257">15.1. 配置客户端提示符</a></li>
<li><a href="#org42993a3">15.2. 开启通用日志，慢日志和 binlog</a></li>
<li><a href="#org264aca9">15.3. 创建用户和数据库</a></li>
<li><a href="#orgd17209d">15.4. 修改用户密码</a></li>
</ul>
</li>
<li><a href="#org8a5e8ca">16. 参考连接</a></li>
</ul>
</div>
</div>


<div id="outline-container-orga99b70b" class="outline-2">
<h2 id="orga99b70b"><span class="section-number-2">1</span> 简介</h2>
<div class="outline-text-2" id="text-1">
<p>
<a href="http://www.mysql.com">MySQL</a> 是一个关系型数据库管理系统，由瑞典 MySQL AB 公司开发，目前属于 Oracle 旗
下产品。MySQL 是最流行的关系型数据库管理系统之一，在 WEB 应用方面，MySQL 是最好
的 RDBMS (Relational Database Management System，关系数据库管理系统) 应用软件
之一。
</p>
</div>

<div id="outline-container-orgf1f2c72" class="outline-3">
<h3 id="orgf1f2c72"><span class="section-number-3">1.1</span> 安装 MySQL</h3>
<div class="outline-text-3" id="text-1-1">
</div>
<div id="outline-container-orgfd2f59f" class="outline-4">
<h4 id="orgfd2f59f"><span class="section-number-4">1.1.1</span> Mac</h4>
<div class="outline-text-4" id="text-1-1-1">
<p>
Mac 上当然是使用 Homebrew 安装最省心了，
</p>
<div class="org-src-container">
<pre class="src src-sh">brew install mysql@5.7
<span style="color: #586e75; font-style: italic;"># </span><span style="color: #586e75; font-style: italic;">&#21021;&#22987;&#21270;&#25968;&#25454;&#24211;</span>
sudo mysql_secure_installation
<span style="color: #586e75; font-style: italic;"># </span><span style="color: #586e75; font-style: italic;">&#28155;&#21152;&#21040; homebrew &#30340;&#26381;&#21153;</span>
brew services start mysql@5.7
</pre>
</div>

<p>
使用命令行登录方法：
</p>
<div class="org-src-container">
<pre class="src src-text">% mysql -uroot -p
Enter password:
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 902
Server version: 5.7.25 Homebrew

Copyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql&gt;
</pre>
</div>
<div class="org-src-container">
<pre class="src src-sh">mysql -h &lt;host&gt; -u &lt;user&gt; -p &lt;password&gt; &lt;database&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org8938e4f" class="outline-4">
<h4 id="org8938e4f"><span class="section-number-4">1.1.2</span> Windows</h4>
<div class="outline-text-4" id="text-1-1-2">
<p>
提前下载 MySQL 社区版（ <a href="https://dev.mysql.com/downloads/mysql/">最新版</a>，<a href="https://dev.mysql.com/downloads/mysql/5.7.html#downloads">5.7</a>）的安装文件，直接根据提示安装。
</p>
</div>
</div>
<div id="outline-container-orgf1059b1" class="outline-4">
<h4 id="orgf1059b1"><span class="section-number-4">1.1.3</span> Unix</h4>
<div class="outline-text-4" id="text-1-1-3">
<p>
Mysql 依赖 libaio 库，在安装 mysql 的机器时需要提前安装 libaio 库。
</p>
<div class="org-src-container">
<pre class="src src-sh">apt-get install libaio1
apt-get install mysql-client mysql-server
</pre>
</div>
</div>
</div>
<div id="outline-container-org9f06aa3" class="outline-4">
<h4 id="org9f06aa3"><span class="section-number-4">1.1.4</span> Docker</h4>
<div class="outline-text-4" id="text-1-1-4">
<p>
下载 mysql 5.7 的镜像
</p>
<div class="org-src-container">
<pre class="src src-sh">docker pull mysql:5.7
</pre>
</div>

<p>
启动 mysql 镜像即可
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #586e75; font-style: italic;"># </span><span style="color: #586e75; font-style: italic;">&#21551;&#21160;&#35064; root &#29992;&#25143;&#30340;&#23481;&#22120;</span>
docker run -d --restart always --name mysql <span style="color: #2aa198;">\</span>
       -e <span style="color: #2aa198;">'MYSQL_ROOT_PASSWORD=root'</span> <span style="color: #2aa198;">\</span>
       -p 3306:3306 mysql:5.7

<span style="color: #586e75; font-style: italic;"># </span><span style="color: #586e75; font-style: italic;">&#21551;&#21160;&#24102;&#26377;&#21021;&#22987;&#21270;&#25968;&#25454;&#24211;&#30340;&#23481;&#22120;</span>
docker run -d --restart always --name mysql <span style="color: #2aa198;">\</span>
       -e <span style="color: #2aa198;">'MYSQL_ROOT_PASSWORD=root'</span> <span style="color: #2aa198;">\</span>
       -e <span style="color: #2aa198;">'MYSQL_USER=username'</span> <span style="color: #2aa198;">\</span>
       -e <span style="color: #2aa198;">'MYSQL_PASSWORD=password'</span> <span style="color: #2aa198;">\</span>
       -e <span style="color: #2aa198;">'MYSQL_DATABASE=database'</span> <span style="color: #2aa198;">\</span>
       -p 3306:3306 mysql:5.7
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgc68cdac" class="outline-3">
<h3 id="orgc68cdac"><span class="section-number-3">1.2</span> 参考手册</h3>
<div class="outline-text-3" id="text-1-2">
<ol class="org-ol">
<li><a href="https://dev.mysql.com/doc/">MySQL 文档</a></li>
<li><a href="https://hub.docker.com/_/mysql">MySQL on Docker Hub</a></li>
</ol>
</div>
</div>
<div id="outline-container-orge18add8" class="outline-3">
<h3 id="orge18add8"><span class="section-number-3">1.3</span> 帮助系统 - <code>\h</code> 命令</h3>
<div class="outline-text-3" id="text-1-3">
<div class="org-src-container">
<pre class="src src-text">mysql&gt; \h
For information about MySQL products and services, visit:
   http://www.mysql.com/
For developer information, including the MySQL Reference Manual, visit:
   http://dev.mysql.com/
To buy MySQL Enterprise support, training, or other products, visit:
   https://shop.mysql.com/

List of all MySQL commands:
Note that all text commands must be first on line and end with ';'
?         (\?) Synonym for `help'.
clear     (\c) Clear the current input statement.
connect   (\r) Reconnect to the server. Optional arguments are db and host.
delimiter (\d) Set statement delimiter.
edit      (\e) Edit command with $EDITOR.
ego       (\G) Send command to mysql server, display result vertically.
exit      (\q) Exit mysql. Same as quit.
go        (\g) Send command to mysql server.
help      (\h) Display this help.
nopager   (\n) Disable pager, print to stdout.
notee     (\t) Don't write into outfile.
pager     (\P) Set PAGER [to_pager]. Print the query results via PAGER.

print     (\p) Print current command.
prompt    (\R) Change your mysql prompt.
quit      (\q) Quit mysql.
rehash    (\#) Rebuild completion hash.
source    (\.) Execute an SQL script file. Takes a file name as an argument.
status    (\s) Get status information from the server.
system    (\!) Execute a system shell command.
tee       (\T) Set outfile [to_outfile]. Append everything into given outfile.
use       (\u) Use another database. Takes database name as argument.
charset   (\C) Switch to another charset. Might be needed for processing binlog with multi-byte charsets.
warnings  (\W) Show warnings after every statement.
nowarning (\w) Don't show warnings after every statement.
resetconnection(\x) Clean session context.

For server side help, type 'help contents'

mysql&gt; \h show
Name: 'SHOW'
Description:
SHOW has many forms that provide information about databases, tables,
columns, or status information about the server. This section describes
those following:

SHOW {BINARY | MASTER} LOGS
SHOW BINLOG EVENTS [IN 'log_name'] [FROM pos] [LIMIT [offset,] row_count]
SHOW CHARACTER SET [like_or_where]
SHOW COLLATION [like_or_where]
SHOW [FULL] COLUMNS FROM tbl_name [FROM db_name] [like_or_where]
SHOW CREATE DATABASE db_name
SHOW CREATE EVENT event_name
SHOW CREATE FUNCTION func_name
SHOW CREATE PROCEDURE proc_name
SHOW CREATE TABLE tbl_name
SHOW CREATE TRIGGER trigger_name
SHOW CREATE VIEW view_name
SHOW DATABASES [like_or_where]
SHOW ENGINE engine_name {STATUS | MUTEX}
SHOW [STORAGE] ENGINES
SHOW ERRORS [LIMIT [offset,] row_count]
SHOW EVENTS
SHOW FUNCTION CODE func_name
SHOW FUNCTION STATUS [like_or_where]
SHOW GRANTS FOR user
SHOW INDEX FROM tbl_name [FROM db_name]
SHOW MASTER STATUS
SHOW OPEN TABLES [FROM db_name] [like_or_where]
SHOW PLUGINS

SHOW PROCEDURE CODE proc_name
SHOW PROCEDURE STATUS [like_or_where]
SHOW PRIVILEGES
SHOW [FULL] PROCESSLIST
SHOW PROFILE [types] [FOR QUERY n] [OFFSET n] [LIMIT n]
SHOW PROFILES
SHOW RELAYLOG EVENTS [IN 'log_name'] [FROM pos] [LIMIT [offset,] row_count]
SHOW SLAVE HOSTS
SHOW SLAVE STATUS [FOR CHANNEL channel]
SHOW [GLOBAL | SESSION] STATUS [like_or_where]
SHOW TABLE STATUS [FROM db_name] [like_or_where]
SHOW [FULL] TABLES [FROM db_name] [like_or_where]
SHOW TRIGGERS [FROM db_name] [like_or_where]
SHOW [GLOBAL | SESSION] VARIABLES [like_or_where]
SHOW WARNINGS [LIMIT [offset,] row_count]

like_or_where:
    LIKE 'pattern'
  | WHERE expr

If the syntax for a given SHOW statement includes a LIKE 'pattern'
part, 'pattern' is a string that can contain the SQL % and _ wildcard
characters. The pattern is useful for restricting statement output to
matching values.

Several SHOW statements also accept a WHERE clause that provides more
flexibility in specifying which rows to display. See

http://dev.mysql.com/doc/refman/5.7/en/extended-show.html.

URL: http://dev.mysql.com/doc/refman/5.7/en/show.html


mysql&gt; \h show create table
Name: 'SHOW CREATE TABLE'
Description:
Syntax:
SHOW CREATE TABLE tbl_name

Shows the CREATE TABLE statement that creates the named table. To use
this statement, you must have some privilege for the table. This
statement also works with views.
SHOW CREATE TABLE quotes table and column names according to the value
of the sql_quote_show_create option. See
http://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html.

For information about how CREATE TABLE statements are stored by MySQL,
see
http://dev.mysql.com/doc/refman/5.7/en/create-table-statement-retention
.html.

URL: http://dev.mysql.com/doc/refman/5.7/en/show-create-table.html

Examples:
mysql&gt; SHOW CREATE TABLE t\G
*************************** 1. row ***************************
       Table: t
Create Table: CREATE TABLE `t` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `s` char(60) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1

mysql&gt; \h alter table
Name: 'ALTER TABLE'
Description:
Syntax:
ALTER TABLE tbl_name
    [alter_specification [, alter_specification] ...]
    [partition_options]

alter_specification:
    table_options
  | ADD [COLUMN] col_name column_definition
        [FIRST | AFTER col_name]
  | ADD [COLUMN] (col_name column_definition,...)
  | ADD {INDEX|KEY} [index_name]
        [index_type] (key_part,...) [index_option] ...
  | ADD [CONSTRAINT [symbol]] PRIMARY KEY
        [index_type] (key_part,...) [index_option] ...
  | ADD [CONSTRAINT [symbol]]
        UNIQUE [INDEX|KEY] [index_name]
        [index_type] (key_part,...) [index_option] ...
  | ADD FULLTEXT [INDEX|KEY] [index_name]
        (key_part,...) [index_option] ...
  | ADD SPATIAL [INDEX|KEY] [index_name]
        (key_part,...) [index_option] ...
  | ADD [CONSTRAINT [symbol]]
        FOREIGN KEY [index_name] (col_name,...)
        reference_definition
  | ALGORITHM [=] {DEFAULT|INPLACE|COPY}

  | ALTER [COLUMN] col_name {SET DEFAULT literal | DROP DEFAULT}
  | CHANGE [COLUMN] old_col_name new_col_name column_definition
        [FIRST|AFTER col_name]
  | [DEFAULT] CHARACTER SET [=] charset_name [COLLATE [=] collation_name]
  | CONVERT TO CHARACTER SET charset_name [COLLATE collation_name]
  | {DISABLE|ENABLE} KEYS
  | {DISCARD|IMPORT} TABLESPACE
  | DROP [COLUMN] col_name
  | DROP {INDEX|KEY} index_name
  | DROP PRIMARY KEY
  | DROP FOREIGN KEY fk_symbol
  | FORCE
  | LOCK [=] {DEFAULT|NONE|SHARED|EXCLUSIVE}
  | MODIFY [COLUMN] col_name column_definition
        [FIRST | AFTER col_name]
  | ORDER BY col_name [, col_name] ...
  | RENAME {INDEX|KEY} old_index_name TO new_index_name
  | RENAME [TO|AS] new_tbl_name
  | {WITHOUT|WITH} VALIDATION
  | ADD PARTITION (partition_definition)
  | DROP PARTITION partition_names
  | DISCARD PARTITION {partition_names | ALL} TABLESPACE
  | IMPORT PARTITION {partition_names | ALL} TABLESPACE
  | TRUNCATE PARTITION {partition_names | ALL}
  | COALESCE PARTITION number

  | REORGANIZE PARTITION partition_names INTO (partition_definitions)
  | EXCHANGE PARTITION partition_name WITH TABLE tbl_name [{WITH|WITHOUT} VALIDATION]
  | ANALYZE PARTITION {partition_names | ALL}
  | CHECK PARTITION {partition_names | ALL}
  | OPTIMIZE PARTITION {partition_names | ALL}
  | REBUILD PARTITION {partition_names | ALL}
  | REPAIR PARTITION {partition_names | ALL}
  | REMOVE PARTITIONING
  | UPGRADE PARTITIONING

key_part:
    col_name [(length)] [ASC | DESC]

index_type:
    USING {BTREE | HASH}

index_option:
    KEY_BLOCK_SIZE [=] value
  | index_type
  | WITH PARSER parser_name
  | COMMENT 'string'

table_options:
    table_option [[,] table_option] ...

table_option:
    AUTO_INCREMENT [=] value
  | AVG_ROW_LENGTH [=] value
  | [DEFAULT] CHARACTER SET [=] charset_name
  | CHECKSUM [=] {0 | 1}
  | [DEFAULT] COLLATE [=] collation_name
  | COMMENT [=] 'string'
  | COMPRESSION [=] {'ZLIB'|'LZ4'|'NONE'}
  | CONNECTION [=] 'connect_string'

  | {DATA|INDEX} DIRECTORY [=] 'absolute path to directory'
  | DELAY_KEY_WRITE [=] {0 | 1}
  | ENCRYPTION [=] {'Y' | 'N'}
  | ENGINE [=] engine_name
  | INSERT_METHOD [=] { NO | FIRST | LAST }
  | KEY_BLOCK_SIZE [=] value
  | MAX_ROWS [=] value
  | MIN_ROWS [=] value
  | PACK_KEYS [=] {0 | 1 | DEFAULT}
  | PASSWORD [=] 'string'
  | ROW_FORMAT [=] {DEFAULT|DYNAMIC|FIXED|COMPRESSED|REDUNDANT|COMPACT}
  | STATS_AUTO_RECALC [=] {DEFAULT|0|1}
  | STATS_PERSISTENT [=] {DEFAULT|0|1}
  | STATS_SAMPLE_PAGES [=] value
  | TABLESPACE tablespace_name [STORAGE {DISK|MEMORY|DEFAULT}]
  | UNION [=] (tbl_name[,tbl_name]...)

partition_options:
    (see CREATE TABLE options)

ALTER TABLE changes the structure of a table. For example, you can add
or delete columns, create or destroy indexes, change the type of
existing columns, or rename columns or the table itself. You can also
change characteristics such as the storage engine used for the table or
the table comment.

o To use ALTER TABLE, you need ALTER, CREATE, and INSERT privileges for

  the table. Renaming a table requires ALTER and DROP on the old table,
  ALTER, CREATE, and INSERT on the new table.

o Following the table name, specify the alterations to be made. If none
  are given, ALTER TABLE does nothing.

o The syntax for many of the permissible alterations is similar to
  clauses of the CREATE TABLE statement. column_definition clauses use
  the same syntax for ADD and CHANGE as for CREATE TABLE. For more
  information, see [HELP CREATE TABLE].

o The word COLUMN is optional and can be omitted.

o Multiple ADD, ALTER, DROP, and CHANGE clauses are permitted in a
  single ALTER TABLE statement, separated by commas. This is a MySQL
  extension to standard SQL, which permits only one of each clause per
  ALTER TABLE statement. For example, to drop multiple columns in a
  single statement, do this:

ALTER TABLE t2 DROP COLUMN c, DROP COLUMN d;

o If a storage engine does not support an attempted ALTER TABLE
  operation, a warning may result. Such warnings can be displayed with

  SHOW WARNINGS. See [HELP SHOW WARNINGS]. For information on
  troubleshooting ALTER TABLE, see
  http://dev.mysql.com/doc/refman/5.7/en/alter-table-problems.html.

o For information about generated columns, see
  http://dev.mysql.com/doc/refman/5.7/en/alter-table-generated-columns.
  html.

o For usage examples, see
  http://dev.mysql.com/doc/refman/5.7/en/alter-table-examples.html.

o With the mysql_info() C API function, you can find out how many rows
  were copied by ALTER TABLE. See
  http://dev.mysql.com/doc/refman/5.7/en/mysql-info.html.

URL: http://dev.mysql.com/doc/refman/5.7/en/alter-table.html

mysql &gt;
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org5e24828" class="outline-2">
<h2 id="org5e24828"><span class="section-number-2">2</span> 数据库操作</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org5f42a50" class="outline-3">
<h3 id="org5f42a50"><span class="section-number-3">2.1</span> 查看数据库基本信息</h3>
<div class="outline-text-3" id="text-2-1">
<div class="org-src-container">
<pre class="src src-sql">mysql&gt; status
<span style="color: #586e75; font-style: italic;">--------------</span>
mysql  Ver 14.14 Distrib 5.7.23, <span style="color: #859900;">for</span> osx10.12 (x86_64) <span style="color: #859900;">using</span>  EditLine wrapper

<span style="color: #859900;">Connection</span> id:    2
<span style="color: #859900;">Current</span> database: sellsys
<span style="color: #859900;">Current</span> <span style="color: #6c71c4;">user</span>:   root@172.17.0.1
SSL:      Cipher <span style="color: #859900;">in</span> use <span style="color: #859900;">is</span> DHE-RSA-AES256-SHA
<span style="color: #859900;">Current</span> pager:    <span style="color: #859900;">less</span>
<span style="color: #859900;">Using</span> outfile:    <span style="color: #2aa198;">''</span>
<span style="color: #859900;">Using</span> delimiter:  ;
Server version:   5.7.26 MySQL Community Server (GPL)
Protocol version: 10
<span style="color: #859900;">Connection</span>:   127.0.0.1 via TCP/IP
Server characterset:  latin1
Db     characterset:  latin1
Client characterset:  utf8
Conn.  characterset:  utf8
TCP port:   3306
Uptime:     18 <span style="color: #6c71c4;">min</span> 40 sec

Threads: 2  Questions: 82  Slow queries: 0  Opens: 139  Flush tables: 1  <span style="color: #859900;">Open</span> tables: 130  Queries per <span style="color: #859900;">second</span> <span style="color: #6c71c4;">avg</span>: 0.073
<span style="color: #586e75; font-style: italic;">--------------</span>

mysql&gt; <span style="color: #859900;">SELECT</span> database();
+<span style="color: #586e75; font-style: italic;">------------+</span>
| database() |
+<span style="color: #586e75; font-style: italic;">------------+</span>
| sellsys    |
+<span style="color: #586e75; font-style: italic;">------------+</span>
1 <span style="color: #268bd2;">row</span> <span style="color: #859900;">in</span> <span style="color: #859900;">set</span> (0.01 sec)

mysql&gt; <span style="color: #859900;">SELECT</span> now();
+<span style="color: #586e75; font-style: italic;">---------------------+</span>
| now()               |
+<span style="color: #586e75; font-style: italic;">---------------------+</span>
| 2019-07-05 20:26:38 |
+<span style="color: #586e75; font-style: italic;">---------------------+</span>
1 <span style="color: #268bd2;">row</span> <span style="color: #859900;">in</span> <span style="color: #859900;">set</span> (0.00 sec)

mysql&gt; <span style="color: #859900;">SELECT</span> <span style="color: #6c71c4;">user</span>();
+<span style="color: #586e75; font-style: italic;">-----------------------+</span>
| <span style="color: #6c71c4;">user</span>()                |
+<span style="color: #586e75; font-style: italic;">-----------------------+</span>
| selladmin@192.168.1.5 |
+<span style="color: #586e75; font-style: italic;">-----------------------+</span>
1 <span style="color: #268bd2;">row</span> <span style="color: #859900;">in</span> <span style="color: #859900;">set</span> (0.01 sec)

mysql&gt; <span style="color: #859900;">SELECT</span> version();
+<span style="color: #586e75; font-style: italic;">-----------+</span>
| version() |
+<span style="color: #586e75; font-style: italic;">-----------+</span>
| 5.7.25    |
+<span style="color: #586e75; font-style: italic;">-----------+</span>
1 <span style="color: #268bd2;">row</span> <span style="color: #859900;">in</span> <span style="color: #859900;">set</span> (0.00 sec)

mysql&gt; SHOW PROCESSLIST; <span style="color: #586e75; font-style: italic;">-- &#26597;&#30475;&#21738;&#20123;&#32447;&#31243;&#27491;&#22312;&#36816;&#34892;</span>
+<span style="color: #586e75; font-style: italic;">-----+-----------+-------------------+---------+---------+------+----------+------------------+</span>
| Id  | <span style="color: #6c71c4;">User</span>      | <span style="color: #859900;">Host</span>              | db      | Command | <span style="color: #268bd2;">Time</span> | <span style="color: #859900;">State</span>    | Info             |
+<span style="color: #586e75; font-style: italic;">-----+-----------+-------------------+---------+---------+------+----------+------------------+</span>
| 900 | selladmin | 192.168.1.5:52231 | sellsys | Query   |    0 | starting | SHOW PROCESSLIST |
+<span style="color: #586e75; font-style: italic;">-----+-----------+-------------------+---------+---------+------+----------+------------------+</span>
1 <span style="color: #268bd2;">row</span> <span style="color: #859900;">in</span> <span style="color: #859900;">set</span> (0.00 sec)

mysql&gt; SHOW DATABASES;
+<span style="color: #586e75; font-style: italic;">--------------------+</span>
| Database           |
+<span style="color: #586e75; font-style: italic;">--------------------+</span>
| information_schema |
| sellsys            |
+<span style="color: #586e75; font-style: italic;">--------------------+</span>
2 <span style="color: #859900;">rows</span> <span style="color: #859900;">in</span> <span style="color: #859900;">set</span> (0.01 sec)

mysql&gt; SHOW <span style="color: #859900;">CREATE</span> DATABASE sellsys;
+<span style="color: #586e75; font-style: italic;">----------+---------------------------------------------------------------------+</span>
| Database | <span style="color: #859900;">Create</span> Database                                                     |
+<span style="color: #586e75; font-style: italic;">----------+---------------------------------------------------------------------+</span>
| sellsys  | <span style="color: #859900;">CREATE</span> DATABASE `sellsys` <span style="color: #586e75; font-style: italic;">/*!40100 DEFAULT CHARACTER SET utf8mb4 */</span> |
+<span style="color: #586e75; font-style: italic;">----------+---------------------------------------------------------------------+</span>
1 <span style="color: #268bd2;">row</span> <span style="color: #859900;">in</span> <span style="color: #859900;">set</span> (0.00 sec)
</pre>
</div>
</div>
</div>

<div id="outline-container-org73b4f7d" class="outline-3">
<h3 id="org73b4f7d"><span class="section-number-3">2.2</span> 查看数据库中所有的表</h3>
<div class="outline-text-3" id="text-2-2">
<div class="org-src-container">
<pre class="src src-sql">mysql&gt; SHOW TABLES;
+<span style="color: #586e75; font-style: italic;">-------------------+</span>
| Tables_in_sellsys |
+<span style="color: #586e75; font-style: italic;">-------------------+</span>
| customers         |
| order_items       |
| orders            |
| product_notes     |
| products          |
| vendors           |
+<span style="color: #586e75; font-style: italic;">-------------------+</span>
6 <span style="color: #859900;">rows</span> <span style="color: #859900;">in</span> <span style="color: #859900;">set</span> (0.02 sec)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf717af1" class="outline-3">
<h3 id="orgf717af1"><span class="section-number-3">2.3</span> 创建/删除数据库</h3>
<div class="outline-text-3" id="text-2-3">
<p>
为了节约存储空间，MySQL 的编码中 utf8 是三个字节的编码，utf8mb4 才是真正的四
字节。如果设置数据库编码为 utf8 会导致 emoji 无法存入数据库，所以最好默认设置
utf8mb4 编码。
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">CREATE</span> DATABASE [IF <span style="color: #859900;">NOT</span> <span style="color: #859900;">EXISTS</span>] dbname
  <span style="color: #859900;">DEFAULT</span> <span style="color: #268bd2;">CHARACTER</span> <span style="color: #859900;">SET</span> utf8mb4;

<span style="color: #859900;">DROP</span> DATABASE [IF <span style="color: #859900;">EXISTS</span>] &lt;dbname&gt;;
</pre>
</div>
</div>
</div>

<div id="outline-container-org4661a52" class="outline-3">
<h3 id="org4661a52"><span class="section-number-3">2.4</span> 字符编码和校对集</h3>
<div class="outline-text-3" id="text-2-4">
<p>
数据编码与客户端编码不需一致
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #586e75; font-style: italic;">-- &#26597;&#30475;&#25152;&#26377;&#23383;&#31526;&#38598;&#32534;&#30721;&#39033;</span>
SHOW VARIABLES <span style="color: #859900;">LIKE</span> <span style="color: #2aa198;">'character_set_%'</span>;
<span style="color: #586e75; font-style: italic;">-- character_set_client        &#23458;&#25143;&#31471;&#21521;&#26381;&#21153;&#22120;&#21457;&#36865;&#25968;&#25454;&#26102;&#20351;&#29992;&#30340;&#32534;&#30721;</span>
<span style="color: #586e75; font-style: italic;">-- character_set_results       &#26381;&#21153;&#22120;&#31471;&#23558;&#32467;&#26524;&#36820;&#22238;&#32473;&#23458;&#25143;&#31471;&#25152;&#20351;&#29992;&#30340;&#32534;&#30721;</span>
<span style="color: #586e75; font-style: italic;">-- character_set_connection    &#36830;&#25509;&#23618;&#32534;&#30721;</span>

<span style="color: #586e75; font-style: italic;">-- &#35774;&#32622;&#21464;&#37327;&#20540;</span>
<span style="color: #859900;">SET</span> variable_name = <span style="color: #859900;">value</span>;

<span style="color: #859900;">SET</span> character_set_client = utf8;
<span style="color: #859900;">SET</span> character_set_results = utf8;
<span style="color: #859900;">SET</span> character_set_connection = utf8;
<span style="color: #859900;">SET</span> <span style="color: #859900;">NAMES</span> utf8; <span style="color: #586e75; font-style: italic;">-- &#30456;&#24403;&#20110;&#19978;&#36848;&#19977;&#20010;&#35774;&#32622;</span>

<span style="color: #586e75; font-style: italic;">-- &#26657;&#23545;&#38598;, &#26657;&#23545;&#38598;&#29992;&#20197;&#25490;&#24207;</span>
<span style="color: #586e75; font-style: italic;">-- &#26597;&#30475;&#25152;&#26377;&#23383;&#31526;&#38598;</span>
SHOW <span style="color: #268bd2;">CHARACTER</span> <span style="color: #859900;">SET</span> [<span style="color: #859900;">LIKE</span> <span style="color: #2aa198;">'pattern'</span>]/SHOW CHARSET [<span style="color: #859900;">LIKE</span> <span style="color: #2aa198;">'pattern'</span>];
<span style="color: #586e75; font-style: italic;">-- &#26597;&#30475;&#25152;&#26377;&#26657;&#23545;&#38598;</span>
SHOW <span style="color: #859900;">COLLATION</span> [<span style="color: #859900;">LIKE</span> <span style="color: #2aa198;">'pattern'</span>];
<span style="color: #586e75; font-style: italic;">-- &#35774;&#32622;&#23383;&#31526;&#38598;&#32534;&#30721;</span>
CHARSET charset_name;
<span style="color: #586e75; font-style: italic;">-- &#35774;&#32622;&#26657;&#23545;&#38598;&#32534;&#30721;</span>
<span style="color: #859900;">COLLATE</span> collate_name;
</pre>
</div>

<p>
Mac 下 client 编码不一致导致插入数据出现问题的解决案例
</p>
<div class="org-src-container">
<pre class="src src-text">mysql&gt; insert cust (name) values('&#20989;&#25968;');
ERROR 1366 (HY000): Incorrect string value: '\xE5\x87\xBD\xE6\x95\xB0' for column 'name' at row 1
mysql&gt; status
--------------
mysql  Ver 14.14 Distrib 5.7.23, for osx10.12 (x86_64) using  EditLine wrapper

Connection id:      2
Current database:   sellsys
Current user:       root@172.17.0.1
SSL:            Cipher in use is DHE-RSA-AES256-SHA
Current pager:      less
Using outfile:      ''
Using delimiter:    ;
Server version:     5.7.26 MySQL Community Server (GPL)
Protocol version:   10
Connection:     127.0.0.1 via TCP/IP
Server characterset:    latin1
Db     characterset:    latin1
Client characterset:    utf8
Conn.  characterset:    utf8
TCP port:       3306
Uptime:         18 min 40 sec

Threads: 2  Questions: 82  Slow queries: 0  Opens: 139  Flush tables: 1  Open tables: 130  Queries per second avg: 0.073
--------------

mysql&gt; SHOW VARIABLES LIKE 'character_set_%';
+--------------------------+----------------------------+
| Variable_name            | Value                      |
+--------------------------+----------------------------+
| character_set_client     | utf8                       |
| character_set_connection | utf8                       |
| character_set_database   | latin1                     |
| character_set_filesystem | binary                     |
| character_set_results    | utf8                       |
| character_set_server     | latin1                     |
| character_set_system     | utf8                       |
| character_sets_dir       | /usr/share/mysql/charsets/ |
+--------------------------+----------------------------+
8 rows in set (0.01 sec)

mysql&gt; set character_set_database = utf8;
Query OK, 0 rows affected, 1 warning (0.00 sec)

mysql&gt; set character_set_server = utf8;
Query OK, 0 rows affected (0.00 sec)

mysql&gt; SHOW VARIABLES LIKE 'character_set_%';
+--------------------------+----------------------------+
| Variable_name            | Value                      |
+--------------------------+----------------------------+
| character_set_client     | utf8                       |
| character_set_connection | utf8                       |
| character_set_database   | utf8                       |
| character_set_filesystem | binary                     |
| character_set_results    | utf8                       |
| character_set_server     | utf8                       |
| character_set_system     | utf8                       |
| character_sets_dir       | /usr/share/mysql/charsets/ |
+--------------------------+----------------------------+
8 rows in set (0.01 sec)

mysql&gt; status
--------------
mysql  Ver 14.14 Distrib 5.7.23, for osx10.12 (x86_64) using  EditLine wrapper

Connection id:      2
Current database:   sellsys
Current user:       root@172.17.0.1
SSL:            Cipher in use is DHE-RSA-AES256-SHA
Current pager:      less
Using outfile:      ''
Using delimiter:    ;
Server version:     5.7.26 MySQL Community Server (GPL)
Protocol version:   10
Connection:     127.0.0.1 via TCP/IP
Server characterset:    utf8
Db     characterset:    utf8
Client characterset:    utf8
Conn.  characterset:    utf8
TCP port:       3306
Uptime:         20 min 50 sec

Threads: 2  Questions: 91  Slow queries: 0  Opens: 140  Flush tables: 1  Open tables: 131  Queries per second avg: 0.072
--------------

mysql&gt; drop database sellsys;
Query OK, 1 row affected (0.02 sec)

mysql&gt; create database aa;
Query OK, 1 row affected (0.00 sec)

mysql&gt; show create database aa;
+----------+-------------------------------------------------------------+
| Database | Create Database                                             |
+----------+-------------------------------------------------------------+
| aa       | CREATE DATABASE `aa` /*!40100 DEFAULT CHARACTER SET utf8 */ |
+----------+-------------------------------------------------------------+
1 row in set (0.00 sec)

mysql&gt; status
--------------
mysql  Ver 14.14 Distrib 5.7.23, for osx10.12 (x86_64) using  EditLine wrapper

Connection id:      2
Current database:
Current user:       root@172.17.0.1
SSL:            Cipher in use is DHE-RSA-AES256-SHA
Current pager:      less
Using outfile:      ''
Using delimiter:    ;
Server version:     5.7.26 MySQL Community Server (GPL)
Protocol version:   10
Connection:     127.0.0.1 via TCP/IP
Server characterset:    utf8
Db     characterset:    utf8
Client characterset:    utf8
Conn.  characterset:    utf8
TCP port:       3306
Uptime:         22 min 9 sec

Threads: 2  Questions: 99  Slow queries: 0  Opens: 140  Flush tables: 1  Open tables: 130  Queries per second avg: 0.074
--------------

mysql&gt; use aa;
Database changed
mysql&gt; create table cust(id int primary key auto_increment, name varchar(32));
Query OK, 0 rows affected (0.03 sec)

mysql&gt; show create table cust\G
*************************** 1. row ***************************
       Table: cust
Create Table: CREATE TABLE `cust` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(32) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8
1 row in set (0.00 sec)

mysql&gt; insert cust (name) values('&#20989;&#25968;');
Query OK, 1 row affected (0.01 sec)

mysql&gt; select * from cust;
+----+--------+
| id | name   |
+----+--------+
|  1 | &#20989;&#25968;   |
+----+--------+
1 row in set (0.01 sec)

mysql&gt;
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orge048c49" class="outline-2">
<h2 id="orge048c49"><span class="section-number-2">3</span> 表操作</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org5ab7af7" class="outline-3">
<h3 id="org5ab7af7"><span class="section-number-3">3.1</span> 创建表</h3>
<div class="outline-text-3" id="text-3-1">
<ul class="org-ul">
<li><code>TEMPORARY</code> : 临时表，会话结束时表自动消失</li>
<li>列定义：每个字段必须有数据类型，最后一个字段后不能有逗号</li>
<li>字符集: <code>CHARSET=charset_name</code> 如果表没有设定，则使用数据库字符集</li>
<li>存储引擎: <code>ENGINE=engine_name</code> 表在管理数据时采用的不同的数据结构，结构不同
会导致处理方式、提供的特性操作等不同常见的引擎：InnoDB MyISAM Memory/Heap
BDB Merge Example CSV MaxDB Archive 不同的引擎在保存表的结构和数据时采用不同
的方式
<ul class="org-ul">
<li>MyISAM 表文件含义：.frm 表定义，.MYD 表数据，.MYI 表索引</li>
<li>InnoDB 表文件含义：.frm 表定义，表空间数据和日志文件</li>
<li><code>SHOW ENGINES</code> :显示存储引擎的状态信息</li>
<li><code>SHOW ENGINE engine_name {LOGS|STATUS}</code> :显示存储引擎的日志或状态信息</li>
</ul></li>
<li>数据文件目录 <code>DATA DIRECTORY = 'folder'</code></li>
<li>索引文件目录 <code>INDEX DIRECTORY = 'folder'</code></li>
<li>表注释 <code>COMMENT = 'string'</code></li>
</ul>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">CREATE</span> [<span style="color: #859900;">TEMPORARY</span>] <span style="color: #859900;">TABLE</span>[ IF <span style="color: #859900;">NOT</span> <span style="color: #859900;">EXISTS</span>] [dbname.]tabname (
  <span style="color: #586e75; font-style: italic;">-- columns defines</span>
  colname dbtype [<span style="color: #859900;">NOT</span> <span style="color: #859900;">NULL</span> | <span style="color: #859900;">NULL</span>] [<span style="color: #859900;">DEFAULT</span> DEFAULT_VALUE]
    [AUTO_INCREMENT] [<span style="color: #859900;">UNIQUE</span> [<span style="color: #859900;">KEY</span>] | [<span style="color: #859900;">PRIMARY</span>] <span style="color: #859900;">KEY</span>] [COMMENT <span style="color: #2aa198;">'STRING'</span>]
) [others];

<span style="color: #586e75; font-style: italic;">-- example</span>
<span style="color: #859900;">CREATE</span> <span style="color: #859900;">TABLE</span> `customers` (
  `cust_id` <span style="color: #268bd2;">int</span>(11) <span style="color: #859900;">NOT</span> <span style="color: #859900;">NULL</span> AUTO_INCREMENT,
  `cust_name` <span style="color: #268bd2;">char</span>(50) <span style="color: #859900;">NOT</span> <span style="color: #859900;">NULL</span>,
  `cust_address` <span style="color: #268bd2;">char</span>(50) <span style="color: #859900;">DEFAULT</span> <span style="color: #859900;">NULL</span>,
  `cust_city` <span style="color: #268bd2;">char</span>(50) <span style="color: #859900;">DEFAULT</span> <span style="color: #859900;">NULL</span>,
  `cust_state` <span style="color: #268bd2;">char</span>(5) <span style="color: #859900;">DEFAULT</span> <span style="color: #859900;">NULL</span>,
  `cust_zip` <span style="color: #268bd2;">char</span>(10) <span style="color: #859900;">DEFAULT</span> <span style="color: #859900;">NULL</span>,
  `cust_country` <span style="color: #268bd2;">char</span>(50) <span style="color: #859900;">DEFAULT</span> <span style="color: #859900;">NULL</span>,
  `cust_contact` <span style="color: #268bd2;">char</span>(50) <span style="color: #859900;">DEFAULT</span> <span style="color: #859900;">NULL</span>,
  `cust_email` <span style="color: #268bd2;">char</span>(255) <span style="color: #859900;">DEFAULT</span> <span style="color: #859900;">NULL</span>,
  <span style="color: #859900;">PRIMARY</span> <span style="color: #859900;">KEY</span> (`cust_id`)
) ENGINE=InnoDB <span style="color: #859900;">DEFAULT</span> CHARSET=utf8mb4;
</pre>
</div>
</div>

<div id="outline-container-org1fa9e49" class="outline-4">
<h4 id="org1fa9e49"><span class="section-number-4">3.1.1</span> 数据类型</h4>
<div class="outline-text-4" id="text-3-1-1">
</div>
<ol class="org-ol">
<li><a id="orgc814e54"></a>整型<br />
<div class="outline-text-5" id="text-3-1-1-1">
<ul class="org-ul">
<li><code>int(M)</code> : M 表示总位数</li>
<li>默认存在符号位, 使用 <code>unsigned</code> 来显示指定成无符号存储</li>
<li>显示宽度，如果某个数不够定义字段时设置的位数，则前面以 0 补填, <code>zerofill</code>
属性修改 例：~int(5)~ 插入一个数 '123' , 补填后为 '00123'</li>
<li>在满足要求的情况下，越小越好。</li>
<li>1 表示真，0 表示假。MySQL 没有布尔类型，通过整型 0 和 1 表示。常用
<code>tinyint(1)</code> 表示布尔型。</li>
</ul>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">类型</th>
<th scope="col" class="org-left">字节</th>
<th scope="col" class="org-left">范围（有符号位）</th>
<th scope="col" class="org-left">无符号位</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">tinyint</td>
<td class="org-left">1 字节</td>
<td class="org-left">-128 ~ 127</td>
<td class="org-left">0 ~ 255</td>
</tr>

<tr>
<td class="org-left">smallint</td>
<td class="org-left">2 字节</td>
<td class="org-left">-32768 ~ 32767</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">mediumint</td>
<td class="org-left">3 字节</td>
<td class="org-left">-8388608 ~ 8388607</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">int</td>
<td class="org-left">4 字节</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">bigint</td>
<td class="org-left">8 字节</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</li>

<li><a id="orgc839efe"></a>浮点型<br />
<div class="outline-text-5" id="text-3-1-1-2">
<ul class="org-ul">
<li>浮点型既支持符号位 <code>unsigned</code> 属性，也支持显示宽度 <code>zerofill</code> 属性。不同
于整型，前后均会补填 0. 定义浮点型时，需指定总位数和小数位数。</li>
<li><code>float(M, D)</code> <code>double(M, D)</code> : M 表示总位数，D 表示小数位数。 M 和 D 的大
小 会决定浮点数的范围。不同于整型的固定范围。M 既表示总位数（不包括小数点
和正 负号），也表示显示宽度（所有显示符号均包括）。支持科学计数法表示。浮
点数表 示近似值。</li>
</ul>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">类型</th>
<th scope="col" class="org-left">字节</th>
<th scope="col" class="org-left">范围</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">float</td>
<td class="org-left">4 字节</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">double</td>
<td class="org-left">8 字节</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</li>

<li><a id="orgdbddd74"></a>定点型<br />
<div class="outline-text-5" id="text-3-1-1-3">
<ul class="org-ul">
<li>decimal 可变长度。 <code>decimal(M, D)</code> M 也表示总位数，D表示小数位数。保存一
个精确的数值，不会发生数据的改变，不同于浮点数的四舍五入。将浮点数转换为
字符串来保存，每 9 位数字保存为 4 个字节。</li>
</ul>
</div>
</li>

<li><a id="orgc239785"></a>字符串<br />
<div class="outline-text-5" id="text-3-1-1-4">
<ul class="org-ul">
<li>char 定长字符串，速度快，但浪费空间</li>
<li>varchar 变长字符串，速度慢，但节省空间 M 表示能存储的最大长度，此长度是字
符数，非字节数。 不同的编码，所占用的空间不同。char 最多 255 个字符，与编
码无关。varchar 最多 65535 字符，与编码有关。 一条有效记录最大不能超过
65535 个字节。utf8 最大 为 21844 个字符，gbk 最大为 32766 个字符，latin1
最大为 65532 个字符 varchar 是变长的，需要利用存储空间保存 varchar 的长度，
如果数据小于 255 个 字节，则采用一个字节来保存长度，反之需要两个字节来保
存。varchar 的最大有效 长度由最大行大小和使用的字符集确定。最大有效长度是
65532 字节，因为在 varchar 存字符串时，第一个字节是空的，不存在任何数据，
然后还需两个字节来存 放字符串的长度，所以有效长度是 64432-1-2=65532 字节。
例：若一个表定义为
<code>CREATE TABLE tb(c1 int, c2 char(30), c3 varchar(N)) charset=utf8;</code>
问 N 的最 大值是多少？ 答：(65535-1-2-4-30*3)/3</li>
<li>blob 二进制字符串（字节字符串）tinyblob, blob, mediumblob, longblob</li>
<li>text 非二进制字符串（字符字符串）tinytext, text, mediumtext, longtext
text 在定义时，不需要定义长度，也不会计算总长度。text 类型在定义时，不可
给 default 值</li>
<li>binary, varbinary 类似于 char 和 varchar，用于保存二进制字符串，也就是保
存字节字符串而非字符字符串。char, varchar, text 对应 binary, varbinary,
blob.</li>
</ul>
</div>
</li>

<li><a id="org44db2fc"></a>日期/时间型<br />
<div class="outline-text-5" id="text-3-1-1-5">
<p>
时间或日期类型数据库中直接存储时间戳格式。
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">类型</th>
<th scope="col" class="org-left">字节</th>
<th scope="col" class="org-left">描述</th>
<th scope="col" class="org-left">范围</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">datetime</td>
<td class="org-left">8 字节</td>
<td class="org-left">日期及时间</td>
<td class="org-left">1000-01-01 00:00:00 到 9999-12-31 23:59:59</td>
</tr>

<tr>
<td class="org-left">date</td>
<td class="org-left">3 字节</td>
<td class="org-left">日期</td>
<td class="org-left">1000-01-01 到 9999-12-31</td>
</tr>

<tr>
<td class="org-left">timestamp</td>
<td class="org-left">4 字节</td>
<td class="org-left">时间戳</td>
<td class="org-left">19700101000000 到 2038-01-19 03:14:07</td>
</tr>

<tr>
<td class="org-left">time</td>
<td class="org-left">3 字节</td>
<td class="org-left">时间</td>
<td class="org-left">-838:59:59 到 838:59:59</td>
</tr>

<tr>
<td class="org-left">year</td>
<td class="org-left">1 字节</td>
<td class="org-left">年份</td>
<td class="org-left">1901 - 2155</td>
</tr>
</tbody>
</table>

<p>
设置时间格式可以使用下面举例：
</p>
<ul class="org-ul">
<li>datetime 'YYYY-MM-DD hh:mm:ss'</li>
<li>timestamp 'YY-MM-DD hh:mm:ss' 'YYYYMMDDhhmmss' 'YYMMDDhhmmss'
YYYYMMDDhhmmss YYMMDDhhmmss</li>
<li>date 'YYYY-MM-DD' 'YY-MM-DD' 'YYYYMMDD' 'YYMMDD' 'YYYYMMDD' 'YYMMDD'</li>
<li>time 'hh:mm:ss' 'hhmmss' hhmmss</li>
<li>year 'YYYY' 'YY' YYYY YY</li>
</ul>
</div>
</li>

<li><a id="orgf00977f"></a>枚举和集合<br />
<div class="outline-text-5" id="text-3-1-1-6">
<ul class="org-ul">
<li>枚举 enum(val1, val2, val3&#x2026;)  在已知的值中进行单选。最大数量为 65535.
枚举值在保存时，以 2 个字节的整型(smallint)保存。每个枚举值，按保存的位置
顺序，从 1 开始逐一递增。表现为字符串类型，存储却是整型。 NULL 值的索引是
NULL。  空字符串错误值的索引值是 0。</li>
<li>集合 set(val1, val2, val3&#x2026;)
<code>CREATE TABLE tab (gender SET('男', '女', '无'));</code>
<code>INSERT INTO tab VALUES ('男, 女');</code>
最多可以有 64 个不同的成员。以 bigint 存储，共 8 个字节。采取位运算的形式。当
创建表时，SET 成员值的尾部空格将自动被删除。</li>
</ul>

<p>
一般在数据库中不用， <b>使用整数代替</b> ，具体类型使用程序处理。
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-org2110214" class="outline-4">
<h4 id="org2110214"><span class="section-number-4">3.1.2</span> 列约束</h4>
<div class="outline-text-4" id="text-3-1-2">
</div>
<ol class="org-ol">
<li><a id="orgfbb820b"></a>主键<br />
<div class="outline-text-5" id="text-3-1-2-1">
<ul class="org-ul">
<li>能唯一标识记录的字段，可以作为主键。</li>
<li>一个表只能有一个主键。</li>
<li>主键具有唯一性。</li>
<li>声明字段时，用 PRIMARY KEY 标识。也可以在字段列表之后声明
<code>CREATE TABLE USER (id INT, name varchar(10), PRIMARY KEY (id));</code></li>
<li>主键字段的值不能为 NULL。</li>
<li>主键可以由多个字段共同组成。此时需要在字段列表后声明的方法。
<code>CREATE TABLE USER (id INT, name varchar(10), age INT, PRIMARY KEY (name, age));</code></li>
</ul>
</div>
</li>
<li><a id="org3a1ffb3"></a>唯一性约束<br />
<div class="outline-text-5" id="text-3-1-2-2">
<ul class="org-ul">
<li>UNIQUE 唯一索引（唯一约束）使得某字段的值也不能重复。</li>
</ul>
</div>
</li>

<li><a id="orgd196bf4"></a>NULL 约束<br />
<div class="outline-text-5" id="text-3-1-2-3">
<p>
NULL 默认允许为空。NOT NULL, 不允许为空。
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">INSERT</span> <span style="color: #859900;">INTO</span> TAB <span style="color: #859900;">VALUES</span> (<span style="color: #859900;">NULL</span>, <span style="color: #2aa198;">'VAL'</span>);
</pre>
</div>
<p>
此时表示将第一个字段的值设为 NULL, 取决于该字段是否允许为 NULL
</p>
</div>
</li>

<li><a id="orgadd72eb"></a>DEFAULT 默认值属性<br />
<div class="outline-text-5" id="text-3-1-2-4">
<p>
当前字段的默认值。
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">INSERT</span> <span style="color: #859900;">INTO</span> tab <span style="color: #859900;">VALUES</span> (<span style="color: #859900;">DEFAULT</span>, <span style="color: #2aa198;">'VAL'</span>);    <span style="color: #586e75; font-style: italic;">-- &#27492;&#26102;&#34920;&#31034;&#24378;&#21046;&#20351;&#29992;&#40664;&#35748;&#20540;&#12290;</span>
<span style="color: #859900;">CREATE</span> <span style="color: #859900;">TABLE</span> <span style="color: #b58900;">tab</span> (create_at <span style="color: #268bd2;">TIMESTAMP</span> <span style="color: #859900;">DEFAULT</span> <span style="color: #6c71c4;">CURRENT_TIMESTAMP</span>); <span style="color: #586e75; font-style: italic;">-- &#34920;&#31034;&#23558;&#24403;&#21069;&#26102;&#38388;&#30340;&#26102;&#38388;&#25139;&#35774;&#20026;&#40664;&#35748;&#20540;&#12290;</span>
<span style="color: #6c71c4;">CURRENT_DATE</span>, <span style="color: #6c71c4;">CURRENT_TIME</span>
</pre>
</div>
</div>
</li>

<li><a id="org1a4e55a"></a><code>AUTO_INCREMENT</code> 自动增长约束<br />
<div class="outline-text-5" id="text-3-1-2-5">
<p>
自动增长必须为索引（主键或 UNIQUE）只能存在一个字段为自动增长。默认为 1 开
始自动增长。可以通过表属性 <code>AUTO_INCREMENT = x</code> 进行设置，或
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">ALTER</span> <span style="color: #859900;">TABLE</span> <span style="color: #b58900;">tbl</span> AUTO_INCREMENT = X;
</pre>
</div>
</div>
</li>

<li><a id="org50f1db4"></a>表注释和列注释<br />
<div class="outline-text-5" id="text-3-1-2-6">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">CREATE</span> <span style="color: #859900;">TABLE</span> <span style="color: #b58900;">tab</span> (id <span style="color: #268bd2;">INT</span> ) COMMENT <span style="color: #2aa198;">'&#27880;&#37322;&#20869;&#23481;'</span>;
</pre>
</div>

<p>
一般 MySQL 的列注释不好修改，但是我们可以使用下面的方式来修改列来更新注释。
</p>
<div class="org-src-container">
<pre class="src src-text">mysql&gt; SHOW CREATE TABLE students\G
*************************** 1. row ***************************
       Table: students
Create Table: CREATE TABLE `students` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8
1 row in set (0.00 sec)

mysql&gt;  ALTER TABLE students
    -&gt;    MODIFY COLUMN id
    -&gt;    int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT '&#20027;&#38190;';
Query OK, 0 rows affected (0.01 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql&gt; show create table students\G
*************************** 1. row ***************************
       Table: students
Create Table: CREATE TABLE `students` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT '&#20027;&#38190;',
  `name` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8
1 row in set (0.00 sec)

mysql&gt;
</pre>
</div>
</div>
</li>

<li><a id="orgb9a6086"></a>FOREIGN KEY 外键约束<br />
<div class="outline-text-5" id="text-3-1-2-7">
<p>
用于限制主表与从表数据完整性。 存在外键的表，称之为从表（子表），外键指向
的表，称之为主表（父表）。 作用：保持数据一致性，完整性，主要目的是控制存储
在外键表（从表）中的数据。
</p>

<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">ALTER</span> <span style="color: #859900;">TABLE</span> <span style="color: #b58900;">t1</span> <span style="color: #859900;">ADD</span> <span style="color: #859900;">CONSTRAINT</span> `t1_t2_fk` <span style="color: #859900;">FOREIGN</span> <span style="color: #859900;">KEY</span> (t1_id) <span style="color: #859900;">REFERENCES</span> t2(id);
<span style="color: #586e75; font-style: italic;">-- &#23558;&#34920; t1 &#30340; t1_id &#22806;&#38190;&#20851;&#32852;&#21040;&#34920; t2 &#30340; id &#23383;&#27573;&#12290;</span>
<span style="color: #586e75; font-style: italic;">-- &#27599;&#20010;&#22806;&#38190;&#37117;&#26377;&#19968;&#20010;&#21517;&#23383;&#65292;&#21487;&#20197;&#36890;&#36807; constraint &#25351;&#23450;</span>
</pre>
</div>

<p>
MySQL 中，可以对 InnoDB 引擎使用外键约束：
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">FOREIGN</span> <span style="color: #859900;">KEY</span> (&#22806;&#38190;&#23383;&#27573;&#65289; <span style="color: #859900;">REFERENCES</span> &#20027;&#34920;&#21517; (&#20851;&#32852;&#23383;&#27573;) [&#20027;&#34920;&#35760;&#24405;&#21024;&#38500;&#26102;&#30340;&#21160;&#20316;] [&#20027;&#34920;&#35760;&#24405;&#26356;&#26032;&#26102;&#30340;&#21160;&#20316;]
<span style="color: #586e75; font-style: italic;">-- &#27492;&#26102;&#38656;&#35201;&#26816;&#27979;&#19968;&#20010;&#20174;&#34920;&#30340;&#22806;&#38190;&#38656;&#35201;&#32422;&#26463;&#20026;&#20027;&#34920;&#30340;&#24050;&#23384;&#22312;&#30340;&#20540;&#12290;&#22806;&#38190;&#22312;&#27809;&#26377;&#20851;&#32852;&#30340;&#24773;&#20917;&#19979;&#65292;</span>
<span style="color: #586e75; font-style: italic;">-- &#21487;&#20197;&#35774;&#32622;&#20026; null.&#21069;&#25552;&#26159;&#35813;&#22806;&#38190;&#21015;&#65292;&#27809;&#26377; not null&#12290;</span>
</pre>
</div>
<p>
可以不指定主表记录更改或更新时的动作，那么此时主表的操作被拒绝。如果指定了
ON UPDATE 或 ON DELETE：在删除或更新时，有如下几个操作可以选择:
</p>

<ul class="org-ul">
<li>CASCADE: 级联操作。主表数据被更新（主键值更新），从表也被更新（外键值更
新）。主表记录被删除，从表相关记录也被删除。</li>
<li>RESTRICT: 拒绝父表删除和更新。</li>
<li><p>
SET NULL: 设置为 NULL。 主表数据被更新（主键值更新）， 从表的外键被设置为
NULL。 主表记录被删除，从表相关记录外键被设置成 NULL。但注意，要求该外键
的列，没有 NOT NULL 属性约束。
</p>

<p>
注意，外键只被 InnoDB 存储引擎所支持。其他引擎是不支持的。
</p></li>
</ul>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-orge476511" class="outline-3">
<h3 id="orge476511"><span class="section-number-3">3.2</span> 查看表结构</h3>
<div class="outline-text-3" id="text-3-2">
<div class="org-src-container">
<pre class="src src-sql">SHOW <span style="color: #859900;">CREATE</span> <span style="color: #859900;">TABLE</span> tabname;
<span style="color: #859900;">DESC</span>/<span style="color: #859900;">DESCRIBE</span>/EXPLAIN tabname;
SHOW COLUMNS <span style="color: #859900;">FROM</span> tabname [<span style="color: #859900;">LIKE</span> <span style="color: #2aa198;">'PATTERN'</span>];
SHOW <span style="color: #859900;">TABLE</span> STATUS [<span style="color: #859900;">FROM</span> dbname] [<span style="color: #859900;">LIKE</span> <span style="color: #2aa198;">'pattern'</span>];
</pre>
</div>
<p>
下面是查看表结构的示例
</p>
<div class="org-src-container">
<pre class="src src-text">mysql&gt; SHOW CREATE TABLE customers\G
*************************** 1. row ***************************
       Table: customers
Create Table: CREATE TABLE `customers` (
  `cust_id` int(11) NOT NULL AUTO_INCREMENT,
  `cust_name` char(50) NOT NULL,
  `cust_address` char(50) DEFAULT NULL,
  `cust_city` char(50) DEFAULT NULL,
  `cust_state` char(5) DEFAULT NULL,
  `cust_zip` char(10) DEFAULT NULL,
  `cust_country` char(50) DEFAULT NULL,
  `cust_contact` char(50) DEFAULT NULL,
  `cust_email` char(255) DEFAULT NULL,
  PRIMARY KEY (`cust_id`)
) ENGINE=InnoDB AUTO_INCREMENT=10006 DEFAULT CHARSET=utf8mb4
1 row in set (0.00 sec)

mysql&gt; DESC customers;
+--------------+-----------+------+-----+---------+----------------+
| Field        | Type      | Null | Key | Default | Extra          |
+--------------+-----------+------+-----+---------+----------------+
| cust_id      | int(11)   | NO   | PRI | NULL    | auto_increment |
| cust_name    | char(50)  | NO   |     | NULL    |                |
| cust_address | char(50)  | YES  |     | NULL    |                |
| cust_city    | char(50)  | YES  |     | NULL    |                |
| cust_state   | char(5)   | YES  |     | NULL    |                |
| cust_zip     | char(10)  | YES  |     | NULL    |                |
| cust_country | char(50)  | YES  |     | NULL    |                |
| cust_contact | char(50)  | YES  |     | NULL    |                |
| cust_email   | char(255) | YES  |     | NULL    |                |
+--------------+-----------+------+-----+---------+----------------+
9 rows in set (0.01 sec)

mysql&gt; EXPLAIN customers;
+--------------+-----------+------+-----+---------+----------------+
| Field        | Type      | Null | Key | Default | Extra          |
+--------------+-----------+------+-----+---------+----------------+
| cust_id      | int(11)   | NO   | PRI | NULL    | auto_increment |
| cust_name    | char(50)  | NO   |     | NULL    |                |
| cust_address | char(50)  | YES  |     | NULL    |                |
| cust_city    | char(50)  | YES  |     | NULL    |                |
| cust_state   | char(5)   | YES  |     | NULL    |                |
| cust_zip     | char(10)  | YES  |     | NULL    |                |
| cust_country | char(50)  | YES  |     | NULL    |                |
| cust_contact | char(50)  | YES  |     | NULL    |                |
| cust_email   | char(255) | YES  |     | NULL    |                |
+--------------+-----------+------+-----+---------+----------------+
9 rows in set (0.01 sec)

mysql&gt; SHOW COLUMNS FROM customers;
+--------------+-----------+------+-----+---------+----------------+
| Field        | Type      | Null | Key | Default | Extra          |
+--------------+-----------+------+-----+---------+----------------+
| cust_id      | int(11)   | NO   | PRI | NULL    | auto_increment |
| cust_name    | char(50)  | NO   |     | NULL    |                |
| cust_address | char(50)  | YES  |     | NULL    |                |
| cust_city    | char(50)  | YES  |     | NULL    |                |
| cust_state   | char(5)   | YES  |     | NULL    |                |
| cust_zip     | char(10)  | YES  |     | NULL    |                |
| cust_country | char(50)  | YES  |     | NULL    |                |
| cust_contact | char(50)  | YES  |     | NULL    |                |
| cust_email   | char(255) | YES  |     | NULL    |                |
+--------------+-----------+------+-----+---------+----------------+
9 rows in set (0.00 sec)

mysql&gt; SHOW TABLE STATUS FROM sellsys LIKE 'cust%'\G
*************************** 1. row ***************************
           Name: customers
         Engine: InnoDB
        Version: 10
     Row_format: Dynamic
           Rows: 5
 Avg_row_length: 3276
    Data_length: 16384
Max_data_length: 0
   Index_length: 0
      Data_free: 0
 Auto_increment: 10006
    Create_time: 2019-06-30 00:27:31
    Update_time: 2019-06-30 00:30:49
     Check_time: NULL
      Collation: utf8mb4_general_ci
       Checksum: NULL
 Create_options:
        Comment:
1 row in set (0.01 sec)

mysql&gt;
</pre>
</div>
</div>
</div>
<div id="outline-container-org97c4d45" class="outline-3">
<h3 id="org97c4d45"><span class="section-number-3">3.3</span> 修改表结构</h3>
<div class="outline-text-3" id="text-3-3">
<p>
常见的修改表结果操作如下，如需更多改表操作，见 <code>\h ALTER TABLE</code>
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">ALTER</span> <span style="color: #859900;">TABLE</span> <span style="color: #b58900;">tabname</span>
  <span style="color: #859900;">ADD</span>[ <span style="color: #859900;">COLUMN</span>] colname                       <span style="color: #586e75; font-style: italic;">-- &#22686;&#21152;&#23383;&#27573;</span>
      <span style="color: #859900;">AFTER</span> colname                          <span style="color: #586e75; font-style: italic;">-- &#34920;&#31034;&#22686;&#21152;&#22312;&#35813;&#23383;&#27573;&#21517;&#21518;&#38754;</span>
      <span style="color: #859900;">FIRST</span>                                  <span style="color: #586e75; font-style: italic;">-- &#34920;&#31034;&#22686;&#21152;&#22312;&#31532;&#19968;&#20010;</span>
  <span style="color: #859900;">ADD</span> <span style="color: #859900;">PRIMARY</span> <span style="color: #859900;">KEY</span>(colname)                   <span style="color: #586e75; font-style: italic;">-- &#21019;&#24314;&#20027;&#38190;</span>
  <span style="color: #859900;">ADD</span> <span style="color: #859900;">UNIQUE</span> [idxname] (colnam)              <span style="color: #586e75; font-style: italic;">-- &#21019;&#24314;&#21807;&#19968;&#32034;&#24341;</span>
  <span style="color: #859900;">ADD</span> INDEX [idxname] (colname)              <span style="color: #586e75; font-style: italic;">-- &#21019;&#24314;&#26222;&#36890;&#32034;&#24341;</span>
  <span style="color: #859900;">ADD</span>/<span style="color: #859900;">DROP</span>[ <span style="color: #859900;">COLUMN</span>] colname                  <span style="color: #586e75; font-style: italic;">-- &#21024;&#38500;&#23383;&#27573;</span>
  <span style="color: #859900;">MODIFY</span>[ <span style="color: #859900;">COLUMN</span>] colname dbtype             <span style="color: #586e75; font-style: italic;">-- &#25903;&#25345;&#23545;&#23383;&#27573;&#23646;&#24615;&#36827;&#34892;&#20462;&#25913;&#65292;&#19981;&#33021;&#20462;&#25913;&#23383;&#27573;&#21517;(&#25152;&#26377;&#21407;&#26377;&#23646;&#24615;&#20063;&#38656;&#20889;&#19978;)</span>
  CHANGE[ <span style="color: #859900;">COLUMN</span>] colname new_colname dbtype <span style="color: #586e75; font-style: italic;">-- &#25903;&#25345;&#23545;&#23383;&#27573;&#21517;&#20462;&#25913;</span>
  <span style="color: #859900;">DROP</span> <span style="color: #859900;">PRIMARY</span> <span style="color: #859900;">KEY</span>                           <span style="color: #586e75; font-style: italic;">-- &#21024;&#38500;&#20027;&#38190;(&#21024;&#38500;&#20027;&#38190;&#21069;&#38656;&#21024;&#38500;&#20854; AUTO_INCREMENT &#23646;&#24615;)</span>
  <span style="color: #859900;">DROP</span> INDEX idxname                         <span style="color: #586e75; font-style: italic;">-- &#21024;&#38500;&#32034;&#24341;</span>
  <span style="color: #859900;">DROP</span> <span style="color: #859900;">FOREIGN</span> <span style="color: #859900;">KEY</span> fkname                    <span style="color: #586e75; font-style: italic;">-- &#21024;&#38500;&#22806;&#38190;</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-text">mysql&gt; show create table orders\G
*************************** 1. row ***************************
       Table: orders
Create Table: CREATE TABLE `orders` (
  `order_num` int(11) NOT NULL AUTO_INCREMENT,
  `order_date` datetime NOT NULL,
  `cust_id` int(11) NOT NULL,
  PRIMARY KEY (`order_num`),
  KEY `fk_orders_customers` (`cust_id`),
  CONSTRAINT `fk_orders_customers` FOREIGN KEY (`cust_id`) REFERENCES `customers` (`cust_id`)
) ENGINE=InnoDB AUTO_INCREMENT=20010 DEFAULT CHARSET=utf8mb4
1 row in set (0.00 sec)

mysql&gt; alter table orders add column note varchar(256) comment 'Order Notes';
Query OK, 0 rows affected (0.21 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql&gt; show create table orders\G
*************************** 1. row ***************************
       Table: orders
Create Table: CREATE TABLE `orders` (
  `order_num` int(11) NOT NULL AUTO_INCREMENT,
  `order_date` datetime NOT NULL,
  `cust_id` int(11) NOT NULL,
  `note` varchar(256) DEFAULT NULL COMMENT 'Order Notes',
  PRIMARY KEY (`order_num`),
  KEY `fk_orders_customers` (`cust_id`),
  CONSTRAINT `fk_orders_customers` FOREIGN KEY (`cust_id`) REFERENCES `customers` (`cust_id`)
) ENGINE=InnoDB AUTO_INCREMENT=20010 DEFAULT CHARSET=utf8mb4
1 row in set (0.00 sec)
</pre>
</div>
</div>
</div>
<div id="outline-container-org22d0e95" class="outline-3">
<h3 id="org22d0e95"><span class="section-number-3">3.4</span> 删除/清空表</h3>
<div class="outline-text-3" id="text-3-4">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #586e75; font-style: italic;">-- &#21024;&#38500;&#34920;</span>
<span style="color: #859900;">DROP</span> <span style="color: #859900;">TABLE</span> [IF <span style="color: #859900;">EXISTS</span>] tabname;
<span style="color: #586e75; font-style: italic;">-- &#28165;&#31354;&#34920;&#25968;&#25454;</span>
TRUNCATE [<span style="color: #859900;">TABLE</span>] tabname;
</pre>
</div>
<ul class="org-ul">
<li>TRUNCATE 清空数据, 删除重建表</li>
<li>TRUNCATE 和 DELETE 的区别
<ul class="org-ul">
<li>TRUNCATE 是删除表再创建，DELETE 是逐条删除</li>
<li>TRUNCATE 重置 AUTO<sub>INCREMENT</sub> 的值。而 DELETE 不会</li>
<li>TRUNCATE 不知道删除了几条，而 DELETE 知道。</li>
<li>当被用于带分区的表时，TRUNCATE 会保留分区</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org704b159" class="outline-3">
<h3 id="org704b159"><span class="section-number-3">3.5</span> 复制表</h3>
<div class="outline-text-3" id="text-3-5">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #586e75; font-style: italic;">-- &#22797;&#21046;&#34920;&#32467;&#26500;</span>
<span style="color: #859900;">CREATE</span> <span style="color: #859900;">TABLE</span> <span style="color: #b58900;">tabname</span> <span style="color: #859900;">LIKE</span> src_tabname;
<span style="color: #586e75; font-style: italic;">-- &#22797;&#21046;&#34920;&#32467;&#26500;&#21644;&#25968;&#25454;</span>
<span style="color: #859900;">CREATE</span> <span style="color: #859900;">TABLE</span> <span style="color: #b58900;">tabname</span> [<span style="color: #859900;">AS</span>] <span style="color: #859900;">SELECT</span> * <span style="color: #859900;">FROM</span> src_tabname;
</pre>
</div>
</div>
</div>
<div id="outline-container-org25313f9" class="outline-3">
<h3 id="org25313f9"><span class="section-number-3">3.6</span> 优化表</h3>
<div class="outline-text-3" id="text-3-6">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #586e75; font-style: italic;">-- &#26816;&#26597;&#34920;&#26159;&#21542;&#26377;&#38169;&#35823;</span>
<span style="color: #859900;">CHECK</span> <span style="color: #859900;">TABLE</span> tabname [, tabname] ... [<span style="color: #859900;">option</span>] ...
<span style="color: #586e75; font-style: italic;">-- &#20248;&#21270;&#34920;</span>
OPTIMIZE [<span style="color: #859900;">LOCAL</span> | NO_WRITE_TO_BINLOG] <span style="color: #859900;">TABLE</span> tabname [, tabname] ...
<span style="color: #586e75; font-style: italic;">-- &#20462;&#22797;&#34920;</span>
REPAIR [<span style="color: #859900;">LOCAL</span> | NO_WRITE_TO_BINLOG] <span style="color: #859900;">TABLE</span> tabname [, tabname] ... [QUICK] [EXTENDED] [USE_FRM]
<span style="color: #586e75; font-style: italic;">-- &#20998;&#26512;&#34920;</span>
ANALYZE [<span style="color: #859900;">LOCAL</span> | NO_WRITE_TO_BINLOG] <span style="color: #859900;">TABLE</span> tabname [, tabname] ...
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgba2cae4" class="outline-2">
<h2 id="orgba2cae4"><span class="section-number-2">4</span> 数据操作：增删改查</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org4162324" class="outline-3">
<h3 id="org4162324"><span class="section-number-3">4.1</span> 插入数据</h3>
<div class="outline-text-3" id="text-4-1">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">INSERT</span> [<span style="color: #859900;">INTO</span>] tabname [(colname1, colname2, ...)]
  <span style="color: #859900;">VALUES</span> (value1, value2, ...) [, (value1, value2, ...), ...];

<span style="color: #859900;">INSERT</span> [<span style="color: #859900;">INTO</span>] tabname <span style="color: #859900;">SET</span> colname1=value1[, colname2=value2, ...];
</pre>
</div>

<ul class="org-ul">
<li>可以省略对列的指定，要求 <code>VALUES(...)</code> 括号内，提供给了按照列顺序出现的所有
字段的值。或者使用 SET 语法。 <code>INSERT INTO tab SET FIELD=VALUE,...;</code></li>
<li>可以一次性使用多个值，采用 <code>(), (), ();</code> 的形式。 <code>INSERT INTO tab VALUES
     (), (), ();</code></li>
<li>可以在列值指定时，使用表达式。 <code>INSERT INTO tab VALUES (FIELD_VALUE, 10+10,
     NOW());</code></li>
<li>可以使用一个特殊值 DEFAULT，表示该列使用默认值。 <code>INSERT INTO tab VALUES
     (FIELD_VALUE, DEFAULT);</code></li>
<li>可以通过一个查询的结果，作为需要插入的值。 <code>INSERT INTO tab SELECT ...;</code></li>
<li>可以指定在插入的值出现主键（或唯一索引）冲突时，更新其他非主键列的信息。
<code>INSERT INTO tab VALUES/SET/SELECT ON DUPLICATE KEY UPDATE conlname=value,
     ...;</code></li>
</ul>
</div>
</div>

<div id="outline-container-org7c976c7" class="outline-3">
<h3 id="org7c976c7"><span class="section-number-3">4.2</span> 删除数据</h3>
<div class="outline-text-3" id="text-4-2">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">DELETE</span> <span style="color: #859900;">FROM</span> tabname[ <span style="color: #859900;">WHERE</span> condition] [<span style="color: #859900;">ORDER</span> <span style="color: #859900;">BY</span> ...] [<span style="color: #859900;">LIMIT</span> <span style="color: #859900;">row_count</span>];
</pre>
</div>

<ul class="org-ul">
<li>删除数据比较危险，一般先用 SELECT 查询来调试，等到条件无误后将 SELECT 改成
DELETE 来删除数据。</li>
<li>没有条件子句，则会删除全部</li>
<li>指定删除的最多记录数。LIMIT</li>
<li>可以通过排序条件删除。ORDER BY + LIMIT</li>
<li>支持多表删除，使用类似连接语法。</li>
<li>DELETE FROM 需要删除数据多表 1，表 2 USING 表连接操作 条件。</li>
</ul>
</div>
</div>

<div id="outline-container-orgb085d75" class="outline-3">
<h3 id="orgb085d75"><span class="section-number-3">4.3</span> 更新数据</h3>
<div class="outline-text-3" id="text-4-3">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">UPDATE</span> tabname <span style="color: #859900;">SET</span> colname1=value1[, colname2=value2] [<span style="color: #859900;">WHERE</span> condition];
</pre>
</div>
</div>
</div>
<div id="outline-container-org0aff3c8" class="outline-3">
<h3 id="org0aff3c8"><span class="section-number-3">4.4</span> 查询数据</h3>
<div class="outline-text-3" id="text-4-4">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">SELECT</span> colname1, colname2, ... <span style="color: #859900;">FROM</span> tabname [<span style="color: #859900;">WHERE</span> condition];
</pre>
</div>

<p>
查询数据的语法如下，注意 <code>SELECT</code> 语句中的各个域的顺序。  ~SELECT -&gt;
[ALL|DISTINCT] -&gt; select<sub>expr</sub> -&gt; FROM -&gt; WHERE -&gt; GROUP BY -&gt; HAVING -&gt; ORDER
BY -&gt; LIMIT~
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">SELECT</span>
    [<span style="color: #859900;">ALL</span> | <span style="color: #859900;">DISTINCT</span> | DISTINCTROW ]
      [HIGH_PRIORITY]
      [STRAIGHT_JOIN]
      [SQL_SMALL_RESULT] [SQL_BIG_RESULT] [SQL_BUFFER_RESULT]
      [SQL_CACHE | SQL_NO_CACHE] [SQL_CALC_FOUND_ROWS]
    select_expr [, select_expr ...]
    [<span style="color: #859900;">FROM</span> table_references
      [PARTITION partition_list]
    [<span style="color: #859900;">WHERE</span> where_condition]
    [<span style="color: #859900;">GROUP</span> <span style="color: #859900;">BY</span> {col_name | expr | <span style="color: #859900;">position</span>}
      [<span style="color: #859900;">ASC</span> | <span style="color: #859900;">DESC</span>], ... [<span style="color: #859900;">WITH</span> <span style="color: #859900;">ROLLUP</span>]]
    [<span style="color: #859900;">HAVING</span> where_condition]
    [<span style="color: #859900;">ORDER</span> <span style="color: #859900;">BY</span> {col_name | expr | <span style="color: #859900;">position</span>}
      [<span style="color: #859900;">ASC</span> | <span style="color: #859900;">DESC</span>], ...]
    [<span style="color: #859900;">LIMIT</span> {[offset,] <span style="color: #859900;">row_count</span> | <span style="color: #859900;">row_count</span> OFFSET offset}]
    [<span style="color: #859900;">PROCEDURE</span> procedure_name(argument_list)]
    [<span style="color: #859900;">INTO</span> OUTFILE <span style="color: #2aa198;">'file_name'</span>
        [<span style="color: #268bd2;">CHARACTER</span> <span style="color: #859900;">SET</span> charset_name]
        export_options
      | <span style="color: #859900;">INTO</span> DUMPFILE <span style="color: #2aa198;">'file_name'</span>
      | <span style="color: #859900;">INTO</span> var_name [, var_name]]
    [<span style="color: #859900;">FOR</span> <span style="color: #859900;">UPDATE</span> | LOCK <span style="color: #859900;">IN</span> SHARE MODE]]
</pre>
</div>

<ul class="org-ul">
<li>select<sub>expr</sub>:
<ul class="org-ul">
<li><code>*</code> 表示所有字段，如： <code>SELECT * FROM tab;</code></li>
<li>可以是字段，函数调用，计算公式，如： <code>SELECT name, now(), 2+3 FROM tab;</code></li>
<li>为了简化列或避免多个列标识符崇明，可以对 <code>select_expr</code> 的列起别名。 使用
<code>AS</code> 关键字，也可以省略 <code>AS</code></li>
</ul></li>
<li>FROM 子句
<ul class="org-ul">
<li>为表可以起别名，使用 <code>AS</code> 关键字： <code>SELECT * FROM tab1 AS a, tab2 AS b;</code></li>
<li>FROM 后面跟逗号分隔的从多个表的话表示会形成笛卡尔积</li>
</ul></li>
<li>WHERE 子句
<ul class="org-ul">
<li>整型 1 表示真，0表示假。</li>
<li>运算符：=, &lt;=&gt;, &lt;&gt;, !=, &lt;=, &lt;, &gt;=, &gt;, !, &amp;&amp;, ||, IN (NOT) NULL, (NOT)
LIKE, (NOT) IN, (NOT) BETWEEN AND, IS (NOT), AND, OR, NOT, XOR IS/IS NOT
加上 TURE/FALSE/UNKNOWN，检验某个值的真假&lt;=&gt;与&lt;&gt;功能相同，&lt;=&gt;可用于 NULL
比较</li>
<li>模式通配符： <code>_</code> 任意单个字符; <code>%</code> 任意多个字符，甚至包括零字符，配合 LIKE 使用</li>
<li>单引号需要进行转义 \'</li>
</ul></li>
<li>GROUP BY 子句
<ul class="org-ul">
<li>字段/别名 [排序方式]: 组后会进行排序。升序：ASC，降序：DESC</li>
<li>使用聚合函数: count 返回不同的非 NULL 值数目 count(*)、count(字段); sum
求和; max 求最大值; min 求最小值; avg 求平均值; group<sub>concat</sub> 返回带有来自
一个组的连接的非 NULL 值的字符串结果。组内字符串连接。</li>
</ul></li>
<li>HAVING 子句: 与 WHERE 功能、用法相同，执行时机不同。WHERE 在开始时执行检测
数据，对原数据进行过滤。HAVING 对筛选出的结果再次进行过滤。HAVING 字段必须
是查询出来的，WHERE 字段必须是数据表存在的。WHERE 不可以使用字段的别名，
HAVING 可以。因为执行 WHERE 代码时，可能尚未确定列值。WHERE 不可以使用合计
函数。一般需用合计函数才会用 HAVING SQL 标准要求 HAVING 必须引用 GROUP BY
子句中的列或用于合计函数中的列。</li>
<li>ORDER BY 子句，升序：ASC，降序：DESC 支持多个字段的排序。</li>
<li>LIMIT 子句，限制结果数量子句仅对处理好的结果进行数量限制。将处理好的结果的
看作是一个集合，按照记录出现的顺序，索引从 0 开始。LIMIT 起始位置, 获取条数
省略第一个参数，表示从索引 0 开始。LIMIT 获取条数</li>
<li>DISTINCT/ALL 选项 : DISTINCT 去除重复记录， 默认为 ALL, 全部记录</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgd374759" class="outline-2">
<h2 id="orgd374759"><span class="section-number-2">5</span> 高级查询</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org34d47da" class="outline-3">
<h3 id="org34d47da"><span class="section-number-3">5.1</span> 合并多个查询结果 <code>UNION</code></h3>
<div class="outline-text-3" id="text-5-1">
<p>
将多个 SELECT 查询的结果组合成一个结果集合。
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">SELECT</span> ... <span style="color: #859900;">UNION</span> [<span style="color: #859900;">ALL</span>|<span style="color: #859900;">DISTINCT</span>] <span style="color: #859900;">SELECT</span> ...
</pre>
</div>
<ul class="org-ul">
<li>默认 DISTINCT 方式，即所有返回的行都是唯一的建议，对每个 SELECT 查询加上小
括号包裹。</li>
<li>ORDER BY 排序时，需加上 LIMIT 进行结合。</li>
<li>需要各 SELECT 查询的字段数量一样。</li>
<li>每个 SELECT 查询的字段列表(数量、类型)应一致，因为结果中的字段名以第一条
SELECT 语句为准。</li>
</ul>
</div>
</div>

<div id="outline-container-org139fb8a" class="outline-3">
<h3 id="org139fb8a"><span class="section-number-3">5.2</span> 子查询</h3>
<div class="outline-text-3" id="text-5-2">
<p>
子查询需用括号包裹。
</p>
</div>
<div id="outline-container-org87a4c34" class="outline-4">
<h4 id="org87a4c34"><span class="section-number-4">5.2.1</span> FROM 型子查询</h4>
<div class="outline-text-4" id="text-5-2-1">
<p>
FROM 后要求是一个表，必须给子查询结果取个别名。
</p>
<ul class="org-ul">
<li>简化每个查询内的条件。</li>
<li>FROM 型需将结果生成一个临时表格，可用以原表的锁定的释放。</li>
<li>子查询返回一个表，表型子查询。</li>
</ul>

<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">SELECT</span> *
  <span style="color: #859900;">FROM</span>
      (<span style="color: #859900;">SELECT</span> * <span style="color: #859900;">FROM</span> tab <span style="color: #859900;">WHERE</span> id &gt; 0) <span style="color: #859900;">AS</span> subtab
 <span style="color: #859900;">WHERE</span> id &gt; 1;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd1719ef" class="outline-4">
<h4 id="orgd1719ef"><span class="section-number-4">5.2.2</span> WHERE 型子查询</h4>
<div class="outline-text-4" id="text-5-2-2">
<ul class="org-ul">
<li>子查询返回一个值，标量子查询。</li>
<li>不需要给子查询取别名。</li>
<li>WHERE 子查询内的表，不能直接用以更新。</li>
</ul>

<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">SELECT</span> * <span style="color: #859900;">FROM</span> tab
 <span style="color: #859900;">WHERE</span> money = (<span style="color: #859900;">SELECT</span> <span style="color: #6c71c4;">max</span>(money) <span style="color: #859900;">FROM</span> tab);
</pre>
</div>

<ul class="org-ul">
<li>列子查询
<ul class="org-ul">
<li>如果子查询结果返回的是一列， 使用 IN 或 NOT IN 完成查询</li>
<li>如果子查询返回数据， 使用 EXISTS 和 NOT EXISTS 完成查询。
<code>SELECT column1 FROM t1 WHERE EXISTS (SELECT * FROM t2);</code></li>
</ul></li>
<li>行子查询，即查询条件是一个行。
<code>SELECT * FROM t1 WHERE (id, gender) IN (SELECT id, gender FROM t2);</code>
行构造符： <code>(col1, col2, ...)</code> 或 <code>ROW(col1,f col2, ...)</code>
行构造符通常用于与对能返回两个或两个以上列的子查询进行比较。</li>
<li>特殊运算符
<ul class="org-ul">
<li>!= ALL() 相当于 NOT IN</li>
<li>= SOME() 相当于 IN, <b>ANY 是 SOME 的别名</b></li>
<li>!= SOME() 不等同于 NOT IN，不等于其中某一个</li>
<li>ALL, SOME 可以配合其他运算符一起使用。</li>
</ul></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org75cad2b" class="outline-3">
<h3 id="org75cad2b"><span class="section-number-3">5.3</span> 联表查询</h3>
<div class="outline-text-3" id="text-5-3">
<p>
将多个表的字段进行连接，可以指定连接条件。联表查询包括多种类型，常见的有内连接，外连接等
</p>


<div id="org0191e36" class="figure">
<p><img src="../static/image/2019/07/sql-joins.jpg" alt="sql-joins.jpg" />
</p>
</div>
</div>

<div id="outline-container-org1ba22fd" class="outline-4">
<h4 id="org1ba22fd"><span class="section-number-4">5.3.1</span> 内连接 INNER JOIN</h4>
<div class="outline-text-4" id="text-5-3-1">
<ul class="org-ul">
<li>默认就是内连接，可省略 INNER</li>
<li>只有数据存在时才能发送连接。即连接结果不能出现空行。 ON 表示连接条件。其条
件表达式与 WHERE 类似。也可以省略条件（表示条件永远为真） 也可用 WHERE 表
示连接条件。 还有 USING, 但需字段名相同。 USING (字段名)</li>
<li>交叉连接 CROSS JOIN, 即没有条件的内连接。 <code>SELECT * FROM A CROSS JOIN B;</code></li>
</ul>
</div>
</div>
<div id="outline-container-org22adb90" class="outline-4">
<h4 id="org22adb90"><span class="section-number-4">5.3.2</span> 外连接 OUTER JOIN</h4>
<div class="outline-text-4" id="text-5-3-2">
<ul class="org-ul">
<li>如果数据不存在，也会出现在连接结果中。</li>
<li>左外连接 LEFT JOIN: 如果数据不存在，左表记录会出现，而右表为 NULL 填充</li>
<li>右外连接 RIGHT JOIN: 如果数据不存在，右表记录会出现，而左表为 NULL 填充</li>
</ul>
</div>
</div>
<div id="outline-container-orge03033b" class="outline-4">
<h4 id="orge03033b"><span class="section-number-4">5.3.3</span> 自然连接 NATURAL JOIN</h4>
<div class="outline-text-4" id="text-5-3-3">
<p>
自动判断连接条件完成连接。相当于省略了 USING，会自动查找相同字段名。 <code>NATURAL JOIN</code> ,
<code>NATURAL LEFT JOIN</code>, <code>NATURAL RIGHT JOIN</code>
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org43694d2" class="outline-2">
<h2 id="org43694d2"><span class="section-number-2">6</span> 视图</h2>
<div class="outline-text-2" id="text-6">
<p>
视图是一个虚拟表，其内容由查询定义。同真实的表一样，视图包含一系列带有名称的列
和行数据。但是，视图并不在数据库中以存储的数据值集形式存在。行和列数据来自由定
义视图的查询所引用的表，并且在引用视图时动态生成。视图具有表结构文件，但不存在
数据文件。对其中所引用的基础表来说，视图的作用类似于筛选。定义视图的筛选可以来
自当前或其它数据库的一个或多个表，或者其它视图。通过视图进行查询没有任何限制，
通过它们进行数据修改时的限制也很少。视图是存储在数据库中的查询的 SQL 语句，它
主要出于两种原因：安全原因，视图可以隐藏一些数据，如：社会保险基金表，可以用视
图只显示姓名，地址，而不显示社会保险号和工资数等，另一原因是可使复杂的查询易于
理解和使用。
</p>

<p>
视图作用:
</p>
<ol class="org-ol">
<li>简化业务逻辑</li>
<li>对客户端隐藏真实的表结构</li>
</ol>
</div>

<div id="outline-container-org5fcd524" class="outline-3">
<h3 id="org5fcd524"><span class="section-number-3">6.1</span> 创建视图</h3>
<div class="outline-text-3" id="text-6-1">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">CREATE</span> [<span style="color: #859900;">OR</span> REPLACE] [ALGORITHM = {UNDEFINED | MERGE | TEMPTABLE}]
<span style="color: #859900;">VIEW</span> view_name [(column_list)] <span style="color: #859900;">AS</span> select_statement
</pre>
</div>

<ul class="org-ul">
<li>视图名必须唯一，同时不能与表重名</li>
<li>视图可以使用 SELECT 语句查询到的列名，也可以自己指定相应的列名</li>
<li>视图算法(ALGORITHM), 可以指定视图执行的算法，通过 ALGORITHM 指定
<ul class="org-ul">
<li>MERGE 将视图的查询语句，与外部查询需要先合并再执行</li>
<li>TEMPTABLE 将视图执行完毕后，形成临时表，再做外层查询</li>
<li>UNDEFINED 未定义(默认)，指的是 MySQL 自主去选择相应的算法</li>
</ul></li>
<li>COLUMN<sub>LIST</sub> 如果存在，则数目必须等于 SELECT 语句检索的列数</li>
</ul>
</div>
</div>

<div id="outline-container-org44f5284" class="outline-3">
<h3 id="org44f5284"><span class="section-number-3">6.2</span> 查看结构</h3>
<div class="outline-text-3" id="text-6-2">
<div class="org-src-container">
<pre class="src src-sql">SHOW <span style="color: #859900;">CREATE</span> <span style="color: #859900;">VIEW</span> view_name
</pre>
</div>
</div>
</div>

<div id="outline-container-org0a4ff44" class="outline-3">
<h3 id="org0a4ff44"><span class="section-number-3">6.3</span> 删除视图</h3>
<div class="outline-text-3" id="text-6-3">
<ul class="org-ul">
<li>删除视图后，数据依然存在。</li>
<li>可同时删除多个视图。</li>
</ul>

<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">DROP</span> <span style="color: #859900;">VIEW</span> [IF <span style="color: #859900;">EXISTS</span>] view_name ...
</pre>
</div>
</div>
</div>

<div id="outline-container-org8c1a35f" class="outline-3">
<h3 id="org8c1a35f"><span class="section-number-3">6.4</span> 修改视图结构</h3>
<div class="outline-text-3" id="text-6-4">
<p>
一般不修改视图，因为不是所有的更新视图都会映射到表上。
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">ALTER</span> <span style="color: #859900;">VIEW</span> <span style="color: #b58900;">view_name</span> [(column_list)] <span style="color: #859900;">AS</span> select_statement
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org1c3fcb0" class="outline-2">
<h2 id="org1c3fcb0"><span class="section-number-2">7</span> 事务</h2>
<div class="outline-text-2" id="text-7">
<p>
事务是指逻辑上的一组操作，组成这组操作的各个单元，要不全成功要不全失败。
</p>
<ul class="org-ul">
<li>支持连续 SQL 的集体成功或集体撤销。</li>
<li>事务是数据库在数据晚自习方面的一个功能。</li>
<li>需要利用 InnoDB 或 BDB 存储引擎，对自动提交的特性支持完成。</li>
<li>InnoDB 被称为事务安全型引擎。</li>
</ul>
</div>

<div id="outline-container-org25f9123" class="outline-3">
<h3 id="org25f9123"><span class="section-number-3">7.1</span> 事务的特性 (ACID)</h3>
<div class="outline-text-3" id="text-7-1">
<ul class="org-ul">
<li>原子性（Atomicity）事务是一个不可分割的工作单位，事务中的操作要么都发生，要
么都不发生。</li>
<li>一致性（Consistency）事务前后数据的完整性必须保持一致。
<ul class="org-ul">
<li>事务开始和结束时，外部数据一致</li>
<li>在整个事务过程中，操作是连续的</li>
</ul></li>
<li>隔离性（Isolation）多个用户并发访问数据库时，一个用户的事务不能被其它用户的
事物所干扰，多个并发事务之间的数据要相互隔离。</li>
<li>持久性（Durability）一个事务一旦被提交，它对数据库中的数据改变就是永久性的。</li>
</ul>
</div>
</div>

<div id="outline-container-org41e2ee2" class="outline-3">
<h3 id="org41e2ee2"><span class="section-number-3">7.2</span> 事务的实现</h3>
<div class="outline-text-3" id="text-7-2">
<ul class="org-ul">
<li>要求是事务支持的表类型</li>
<li>执行一组相关的操作前开启事务</li>
<li>整组操作完成后，都成功，则提交；如果存在失败，选择回滚，则会回到事务开始的备
份点。</li>
</ul>
</div>
</div>

<div id="outline-container-org267508c" class="outline-3">
<h3 id="org267508c"><span class="section-number-3">7.3</span> 事务的原理</h3>
<div class="outline-text-3" id="text-7-3">
<p>
利用 InnoDB 的自动提交(autocommit)特性完成。普通的 MySQL 执行语句后，当前的数
据提交操作均可被其他客户端可见。而事务是暂时关闭“自动提交”机制，需要 commit
提交持久化数据操作。 事务有以下注意点：
</p>
<ul class="org-ul">
<li><b>数据定义语言（DDL）语句不能被回滚</b> 比如创建或取消数据库的语句，和创建、取
消或更改表或存储的子程序的语句。</li>
<li><b>事务不能被嵌套</b></li>
</ul>
</div>
</div>

<div id="outline-container-orgdfa3883" class="outline-3">
<h3 id="orgdfa3883"><span class="section-number-3">7.4</span> 事务开始：开启</h3>
<div class="outline-text-3" id="text-7-4">
<p>
开启事务后，所有被执行的 SQL 语句均被认作当前事务内的 SQL 语句。
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">START</span> <span style="color: #859900;">TRANSACTION</span>;
<span style="color: #586e75; font-style: italic;">-- &#25110;&#32773;</span>
<span style="color: #859900;">BEGIN</span>;
</pre>
</div>
</div>
</div>

<div id="outline-container-org081e7b2" class="outline-3">
<h3 id="org081e7b2"><span class="section-number-3">7.5</span> 事务结束：提交和回滚</h3>
<div class="outline-text-3" id="text-7-5">
<p>
事务提交后，事务结束。
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">COMMIT</span>;
</pre>
</div>

<p>
如果部分操作发生问题，映射到事务开启前。
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">ROLLBACK</span>;
</pre>
</div>
</div>
</div>

<div id="outline-container-org613a9af" class="outline-3">
<h3 id="org613a9af"><span class="section-number-3">7.6</span> 事务保存：保存点</h3>
<div class="outline-text-3" id="text-7-6">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">SAVEPOINT</span> spname             <span style="color: #586e75; font-style: italic;">-- &#35774;&#32622;&#19968;&#20010;&#20107;&#21153;&#20445;&#23384;&#28857;</span>
<span style="color: #859900;">ROLLBACK</span> <span style="color: #859900;">TO</span> <span style="color: #859900;">SAVEPOINT</span> spname <span style="color: #586e75; font-style: italic;">-- &#22238;&#28378;&#21040;&#20445;&#23384;&#28857;</span>
RELEASE <span style="color: #859900;">SAVEPOINT</span> spname     <span style="color: #586e75; font-style: italic;">-- &#21024;&#38500;&#20445;&#23384;&#28857;</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7b88b7d" class="outline-3">
<h3 id="org7b88b7d"><span class="section-number-3">7.7</span> InnoDB 自动提交特性设置</h3>
<div class="outline-text-3" id="text-7-7">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #586e75; font-style: italic;">-- 0 &#34920;&#31034;&#20851;&#38381;&#33258;&#21160;&#25552;&#20132;&#65292;1&#34920;&#31034;&#24320;&#21551;&#33258;&#21160;&#25552;&#20132;&#12290;</span>
<span style="color: #859900;">SET</span> autocommit = 0|1;
</pre>
</div>
<ul class="org-ul">
<li>如果关闭了，那普通操作的结果对其他客户端也不可见，需要 COMMIT 提交后才能持
久化数据操作。</li>
<li>也可以关闭自动提交来开启事务。但与 START TRANSACTION 不同的是，
<ul class="org-ul">
<li>SET autocommit 是永久改变服务器的设置，直到下次再次修改该设置。(针对当前
连接)</li>
<li>START TRANSACTION 记录开启前的状态，而一旦事务提交或回滚后就需要再次开启
事务。(针对当前事务)</li>
</ul></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org9cc4326" class="outline-2">
<h2 id="org9cc4326"><span class="section-number-2">8</span> 锁表</h2>
<div class="outline-text-2" id="text-8">
<p>
表锁定只用于防止其它客户端进行不正当地读取和写入
MyISAM 支持表锁，InnoDB 支持行锁
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #586e75; font-style: italic;">-- &#38145;&#23450;</span>
LOCK TABLES tabname [<span style="color: #859900;">AS</span> <span style="color: #859900;">alias</span>];
<span style="color: #586e75; font-style: italic;">-- &#35299;&#38145;</span>
UNLOCK TABLES;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb3b2a48" class="outline-2">
<h2 id="orgb3b2a48"><span class="section-number-2">9</span> 触发器</h2>
<div class="outline-text-2" id="text-9">
<p>
触发程序是与表有关的命名数据库对象，当该表出现特定事件时，将激活该对象监听：记
录的增加、修改、删除。
</p>
</div>

<div id="outline-container-org73faecc" class="outline-3">
<h3 id="org73faecc"><span class="section-number-3">9.1</span> 创建触发器</h3>
<div class="outline-text-3" id="text-9-1">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">CREATE</span> <span style="color: #859900;">TRIGGER</span> <span style="color: #b58900;">tgname</span> tgtime tgevent <span style="color: #859900;">ON</span> tbname <span style="color: #859900;">FOR</span> <span style="color: #859900;">EACH</span> <span style="color: #268bd2;">ROW</span> tgstmt;
</pre>
</div>
<p>
参数：
</p>
<ul class="org-ul">
<li>tgtime 是触发程序的动作时间。它可以是 BEFORE 或 AFTER，以指明触发程序是在激
活它的语句之前或之后触发。</li>
<li>tgevent 指明了激活触发程序的语句的类型
<ul class="org-ul">
<li>INSERT：将新行插入表时激活触发程序</li>
<li>UPDATE：更改某一行时激活触发程序</li>
<li>DELETE：从表中删除某一行时激活触发程序</li>
</ul></li>
<li>tabname：监听的表，必须是永久性的表，不能将触发程序与 TEMPORARY 表或视图关
联起来。</li>
<li>tgstmt：当触发程序激活时执行的语句。执行多个语句，可使用 <code>BEGIN...END</code> 复合
语句结构</li>
</ul>
</div>
</div>

<div id="outline-container-org17b2bed" class="outline-3">
<h3 id="org17b2bed"><span class="section-number-3">9.2</span> 删除触发器</h3>
<div class="outline-text-3" id="text-9-2">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">DROP</span> <span style="color: #859900;">TRIGGER</span> [scmname.]tgname;
</pre>
</div>
<p>
可以使用 old 和 new 代替旧的和新的数据
</p>
<ul class="org-ul">
<li>更新操作，更新前是 old，更新后是 new.</li>
<li>删除操作，只有 old.</li>
<li>增加操作，只有 new.</li>
<li>注意: <b>对于具有相同触发程序动作时间和事件的给定表，不能有两个触发程序</b></li>
</ul>
</div>
</div>

<div id="outline-container-orgbb4e1b0" class="outline-3">
<h3 id="orgbb4e1b0"><span class="section-number-3">9.3</span> 特殊的执行注意项</h3>
<div class="outline-text-3" id="text-9-3">
<ul class="org-ul">
<li>只要添加记录，就会触发程序。</li>
<li><code>INSERT INTO ON DUPLICATE KEY UPDATE</code> 语法会触发：
<ul class="org-ul">
<li>如果没有重复记录，会触发 BEFORE INSERT, AFTER INSERT;</li>
<li>如果有重复记录并更新，会触发 BEFORE INSERT, BEFORE UPDATE, AFTER UPDATE;</li>
<li>如果有重复记录但是没有发生更新，则触发 BEFORE INSERT, BEFORE UPDATE</li>
</ul></li>
<li><code>REPLACE</code> 语法 如果有记录，则执行 BEFORE INSERT, BEFORE DELETE, AFTER DELETE,
AFTER INSERT</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orga217444" class="outline-2">
<h2 id="orga217444"><span class="section-number-2">10</span> SQL 编程</h2>
<div class="outline-text-2" id="text-10">
</div>
<div id="outline-container-org82848d0" class="outline-3">
<h3 id="org82848d0"><span class="section-number-3">10.1</span> 变量</h3>
<div class="outline-text-3" id="text-10-1">
</div>
<div id="outline-container-orgf49eecf" class="outline-4">
<h4 id="orgf49eecf"><span class="section-number-4">10.1.1</span> 变量声明</h4>
<div class="outline-text-4" id="text-10-1-1">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">DECLARE</span> var_name[,...] <span style="color: #859900;">TYPE</span> [<span style="color: #859900;">DEFAULT</span> <span style="color: #859900;">value</span>]
</pre>
</div>
<p>
这个语句被用来声明局部变量。要给变量提供一个默认值，请包含一个 DEFAULT 子句。
值可以被指定为一个表达式，不需要为一个常数。如果没有 DEFAULT 子句，初始值为
NULL。
</p>
</div>
</div>

<div id="outline-container-orge589700" class="outline-4">
<h4 id="orge589700"><span class="section-number-4">10.1.2</span> 全局变量</h4>
<div class="outline-text-4" id="text-10-1-2">
<p>
使用 SET 和 SELECT INTO 语句为变量赋值。注意， <b>在函数内是可以使用全局变量
（用户自定义的变量）</b>
</p>

<p>
SET 语句可以定义并为变量赋值。
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">SET</span> @var = val;
</pre>
</div>
<p>
也可以使用 SELECT INTO 语句为变量初始化并赋值。这样要求 SELECT 语句只能返回
一行，但是可以是多个字段，就意味着同时为多个变量进行赋值，变量的数量需要与查
询的列数一致。还可以把赋值语句看作一个表达式，通过 SELECT 执行完成。此时为了
避免=被当作关系运算符看待，使用:=代替。（SET 语句可以使用= 和 :=）。
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">SELECT</span> @var:=20;
<span style="color: #859900;">SELECT</span> @v1:=id, @v2=<span style="color: #859900;">name</span> <span style="color: #859900;">FROM</span> t1 <span style="color: #859900;">LIMIT</span> 1;
<span style="color: #859900;">SELECT</span> * <span style="color: #859900;">FROM</span> tabname <span style="color: #859900;">WHERE</span> @var:=30;
<span style="color: #586e75; font-style: italic;">-- select into &#21487;&#20197;&#23558;&#34920;&#20013;&#26597;&#35810;&#33719;&#24471;&#30340;&#25968;&#25454;&#36171;&#32473;&#21464;&#37327;&#12290;</span>
<span style="color: #859900;">SELECT</span> <span style="color: #6c71c4;">max</span>(height) <span style="color: #859900;">INTO</span> @max_height <span style="color: #859900;">FROM</span> tb;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgecaa748" class="outline-4">
<h4 id="orgecaa748"><span class="section-number-4">10.1.3</span> 自定义变量名</h4>
<div class="outline-text-4" id="text-10-1-3">
<p>
为了避免 SELECT 语句中，用户自定义的变量与系统标识符（通常是字段名）冲突，用
户自定义变量在变量名前使用 <code>@</code> 作为开始符号。 <code>@var=10;</code> <b>变量被定义后，在整
个会话周期都有效（登录到退出）</b>
</p>
</div>
</div>
</div>

<div id="outline-container-org7f7fd87" class="outline-3">
<h3 id="org7f7fd87"><span class="section-number-3">10.2</span> 控制流</h3>
<div class="outline-text-3" id="text-10-2">
</div>
<div id="outline-container-orgbd297a9" class="outline-4">
<h4 id="orgbd297a9"><span class="section-number-4">10.2.1</span> 分支语句</h4>
<div class="outline-text-4" id="text-10-2-1">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #586e75; font-style: italic;">-- if</span>
IF condition <span style="color: #859900;">THEN</span>
    <span style="color: #586e75; font-style: italic;">-- stmt1</span>
ELSEIF &#26465;&#20214; <span style="color: #859900;">THEN</span>
    <span style="color: #586e75; font-style: italic;">-- stmt2</span>
<span style="color: #859900;">ELSE</span>
    <span style="color: #586e75; font-style: italic;">-- stmt3</span>
<span style="color: #859900;">END</span> IF;

<span style="color: #586e75; font-style: italic;">-- case</span>
<span style="color: #859900;">CASE</span> <span style="color: #859900;">value</span>
  <span style="color: #859900;">WHEN</span> [compare_value] <span style="color: #859900;">THEN</span> <span style="color: #859900;">result</span>
  [<span style="color: #859900;">WHEN</span> [compare_value] <span style="color: #859900;">THEN</span> <span style="color: #859900;">result</span> ...]
  [<span style="color: #859900;">ELSE</span> <span style="color: #859900;">result</span>]
<span style="color: #859900;">END</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org1ef5669" class="outline-4">
<h4 id="org1ef5669"><span class="section-number-4">10.2.2</span> 循环语句</h4>
<div class="outline-text-4" id="text-10-2-2">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #586e75; font-style: italic;">-- loop</span>
[begin_label:] LOOP
  <span style="color: #586e75; font-style: italic;">-- statement_list</span>
<span style="color: #859900;">END</span> LOOP [end_label]

<span style="color: #586e75; font-style: italic;">-- while</span>
[begin_label:] WHILE search_condition DO
  <span style="color: #586e75; font-style: italic;">-- statement_list</span>
<span style="color: #859900;">END</span> WHILE [end_label];
</pre>
</div>
<ul class="org-ul">
<li>如果需要在循环内提前终止 WHILE 循环，则需要使用标签；标签需要成对出现。</li>
<li>退出循环
<ul class="org-ul">
<li>退出整个循环 <code>LEAVE label</code></li>
<li>退出当前循环 <code>ITERATE label</code></li>
<li>通过退出的标签决定退出哪个循环</li>
</ul></li>
</ul>

<p>
编程举例
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">CREATE</span> <span style="color: #859900;">PROCEDURE</span> <span style="color: #b58900;">doiterate</span>(p1 <span style="color: #268bd2;">INT</span>)
<span style="color: #859900;">BEGIN</span>
  label1: LOOP
    <span style="color: #859900;">SET</span> p1 = p1 + 1;
    IF p1 &lt; 10 <span style="color: #859900;">THEN</span>
      <span style="color: #859900;">ITERATE</span> label1;
    <span style="color: #859900;">END</span> IF;
    LEAVE label1;
  <span style="color: #859900;">END</span> LOOP label1;
  <span style="color: #859900;">SET</span> @x = p1;
<span style="color: #859900;">END</span>;

<span style="color: #859900;">CREATE</span> <span style="color: #859900;">PROCEDURE</span> <span style="color: #b58900;">dowhile</span>()
<span style="color: #859900;">BEGIN</span>
  <span style="color: #859900;">DECLARE</span> v1 <span style="color: #268bd2;">INT</span> <span style="color: #859900;">DEFAULT</span> 5;
  WHILE v1 &gt; 0 DO
    ...
    <span style="color: #859900;">SET</span> v1 = v1 - 1;
  <span style="color: #859900;">END</span> WHILE;
<span style="color: #859900;">END</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org361acff" class="outline-4">
<h4 id="org361acff"><span class="section-number-4">10.2.3</span> 语句块包裹</h4>
<div class="outline-text-4" id="text-10-2-3">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">BEGIN</span>
    &#35821;&#21477;&#22359;
<span style="color: #859900;">END</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org5a6a729" class="outline-3">
<h3 id="org5a6a729"><span class="section-number-3">10.3</span> 存储函数和存储过程</h3>
<div class="outline-text-3" id="text-10-3">
</div>
<div id="outline-container-orgde2733d" class="outline-4">
<h4 id="orgde2733d"><span class="section-number-4">10.3.1</span> 存储函数</h4>
<div class="outline-text-4" id="text-10-3-1">
</div>
<ol class="org-ol">
<li><a id="org0ceaaf1"></a>创建存储函数<br />
<div class="outline-text-5" id="text-10-3-1-1">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">CREATE</span> <span style="color: #859900;">FUNCTION</span> <span style="color: #b58900;">funcname</span> (arglist)
  <span style="color: #859900;">RETURNS</span> (rettype)
    body
</pre>
</div>
<ul class="org-ul">
<li>函数名，应该合法的标识符，并且不应该与已有的关键字冲突</li>
<li>一个函数应该属于某个数据库，可以使用 db<sub>name.funciton</sub><sub>name</sub> 的形式执行当前
函数所属数据库，否则为当前数据库</li>
<li>参数部分，由"参数名"和"参数类型"组成。多个参数用逗号隔开</li>
<li>函数体由多条可用的 MySQL 语句，流程控制，变量声明等语句构成</li>
<li>多条语句应该使用 <code>BEGIN...END</code> 语句块包含</li>
<li>一定要有 RETURN 返回值语句</li>
</ul>
</div>
</li>

<li><a id="orgfee8d89"></a>删除存储过程<br />
<div class="outline-text-5" id="text-10-3-1-2">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">DROP</span> <span style="color: #859900;">FUNCTION</span> [IF <span style="color: #859900;">EXISTS</span>] funcname;
</pre>
</div>
</div>
</li>

<li><a id="org12d42dc"></a>查看存储过程<br />
<div class="outline-text-5" id="text-10-3-1-3">
<div class="org-src-container">
<pre class="src src-sql">SHOW <span style="color: #859900;">FUNCTION</span> STATUS <span style="color: #859900;">LIKE</span> <span style="color: #2aa198;">'partten'</span>
SHOW <span style="color: #859900;">CREATE</span> <span style="color: #859900;">FUNCTION</span> funcname;
</pre>
</div>
</div>
</li>

<li><a id="org396084e"></a>修改存储过程<br />
<div class="outline-text-5" id="text-10-3-1-4">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">ALTER</span> <span style="color: #859900;">FUNCTION</span> <span style="color: #b58900;">funcname</span> ...;
</pre>
</div>
</div>
</li>
</ol>
</div>

<div id="outline-container-org8aeed07" class="outline-4">
<h4 id="org8aeed07"><span class="section-number-4">10.3.2</span> 存储过程</h4>
<div class="outline-text-4" id="text-10-3-2">
<p>
存储存储过程 是一段代码（过程），存储在数据库中的 SQL 组成。一个存储过程通常
用于完成一段业务逻辑，例如报名，交班费，订单入库等。而一个函数通常专注与某个
功能，视为其他程序服务的，需要在其他语句中调用函数才可以，而存储过程不能被其
他调用，是自己执行通过 <code>CALL</code> 执行。
</p>
</div>

<ol class="org-ol">
<li><a id="orge5320c0"></a>创建存储过程<br />
<div class="outline-text-5" id="text-10-3-2-1">
<p>
存储过程是一段可执行性代码的集合。相比函数，更偏向于业务逻辑。
</p>
<ul class="org-ul">
<li>调用方法， <code>CALL procname;</code></li>
<li>没有返回值</li>
<li>只能单独调用，不可夹杂在其他语句中</li>
<li>参数， 存储过程必须指定参数类型， <code>IN|OUT|INOUT</code> 参数名 数据类型
<ul class="org-ul">
<li>IN 输入：在调用过程中，将数据输入到过程体内部的参数</li>
<li>OUT 输出：在调用过程中，将过程体处理完的结果返回到客户端</li>
<li>INOUT 输入输出：既可输入，也可输出</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">CREATE</span> <span style="color: #859900;">PROCEDURE</span> <span style="color: #b58900;">procname</span> (arglist)
  body
</pre>
</div>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-org0e2d17a" class="outline-3">
<h3 id="org0e2d17a"><span class="section-number-3">10.4</span> 修改语句的分隔符</h3>
<div class="outline-text-3" id="text-10-4">
<p>
修改最外层语句结束符
</p>
<div class="org-src-container">
<pre class="src src-sql">DELIMITER newsep
  <span style="color: #586e75; font-style: italic;">--- &lt;SQL &#35821;&#21477;&gt;</span>
&#33258;&#23450;&#20041;&#32467;&#26463;&#31526;&#21495;

DELIMITER ;        <span style="color: #586e75; font-style: italic;">-- &#20462;&#25913;&#22238;&#21407;&#26469;&#30340;&#20998;&#21495;</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org60d323c" class="outline-2">
<h2 id="org60d323c"><span class="section-number-2">11</span> 用户及权限管理</h2>
<div class="outline-text-2" id="text-11">
</div>
<div id="outline-container-org333044e" class="outline-3">
<h3 id="org333044e"><span class="section-number-3">11.1</span> 用户表</h3>
<div class="outline-text-3" id="text-11-1">
<ul class="org-ul">
<li>用户信息表: <code>mysql.user</code></li>
<li>刷新权限: <code>FLUSH PRIVILEGES</code></li>
</ul>
</div>
</div>

<div id="outline-container-orgf910cbb" class="outline-3">
<h3 id="orgf910cbb"><span class="section-number-3">11.2</span> 增加用户</h3>
<div class="outline-text-3" id="text-11-2">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">CREATE</span> <span style="color: #6c71c4;">USER</span> username@hostname IDENTIFIED <span style="color: #859900;">BY</span> <span style="color: #2aa198;">'password_string'</span>;
</pre>
</div>
<ul class="org-ul">
<li>必须拥有 mysql 数据库的全局 CREATE USER 权限，或拥有 INSERT 权限。</li>
<li>只能创建用户，不能赋予权限。</li>
<li>写用户名时一定要带上主机名，注意引号。 如 <code>'user_name'@'192.168.1.1'</code> 或
者 <code>'xiaoming'@'%'</code></li>
<li>密码也需引号，纯数字密码也要加引号</li>
<li>要在纯文本中指定密码，需忽略 PASSWORD 关键词。要把密码指定为由 <code>PASSWORD()</code>
函数返回的混编值，需包含关键字 PASSWORD</li>
</ul>
</div>
</div>

<div id="outline-container-org9f3bed9" class="outline-3">
<h3 id="org9f3bed9"><span class="section-number-3">11.3</span> 重命名用户</h3>
<div class="outline-text-3" id="text-11-3">
<div class="org-src-container">
<pre class="src src-sql">RENAME <span style="color: #6c71c4;">USER</span> old_user <span style="color: #859900;">TO</span> new_user;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgefe769f" class="outline-3">
<h3 id="orgefe769f"><span class="section-number-3">11.4</span> 设置密码</h3>
<div class="outline-text-3" id="text-11-4">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">SET</span> PASSWORD = PASSWORD(<span style="color: #2aa198;">'&#23494;&#30721;'</span>);              <span style="color: #586e75; font-style: italic;">-- &#20026;&#24403;&#21069;&#29992;&#25143;&#35774;&#32622;&#23494;&#30721;</span>
<span style="color: #859900;">SET</span> PASSWORD <span style="color: #859900;">FOR</span> username = PASSWORD(<span style="color: #2aa198;">'&#23494;&#30721;'</span>); <span style="color: #586e75; font-style: italic;">-- &#20026;&#25351;&#23450;&#29992;&#25143;&#35774;&#32622;&#23494;&#30721;</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf749416" class="outline-3">
<h3 id="orgf749416"><span class="section-number-3">11.5</span> 删除用户</h3>
<div class="outline-text-3" id="text-11-5">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">DROP</span> <span style="color: #6c71c4;">USER</span> username;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd234e89" class="outline-3">
<h3 id="orgd234e89"><span class="section-number-3">11.6</span> 分配权限/添加用户</h3>
<div class="outline-text-3" id="text-11-6">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">GRANT</span> prvlist <span style="color: #859900;">ON</span> scmname.tabname <span style="color: #859900;">TO</span> username [IDENTIFIED <span style="color: #859900;">BY</span> [PASSWORD] <span style="color: #2aa198;">'password'</span>];
</pre>
</div>
<ul class="org-ul">
<li>prvlist: ALL PRIVILEGES 表示所有权限</li>
<li><b>.</b> 表示所有库的所有表</li>
<li>scmname.tabname 表示某库下面的某表</li>
</ul>
</div>
</div>

<div id="outline-container-org748e6a9" class="outline-3">
<h3 id="org748e6a9"><span class="section-number-3">11.7</span> 查看权限</h3>
<div class="outline-text-3" id="text-11-7">
<div class="org-src-container">
<pre class="src src-sql">SHOW GRANTS <span style="color: #859900;">FOR</span> username;
</pre>
</div>

<p>
查看当前用户权限还可以用以下方法：
</p>
<div class="org-src-container">
<pre class="src src-sql">SHOW GRANTS;
SHOW GRANTS <span style="color: #859900;">FOR</span> <span style="color: #6c71c4;">CURRENT_USER</span>;
SHOW GRANTS <span style="color: #859900;">FOR</span> <span style="color: #6c71c4;">CURRENT_USER</span>();
</pre>
</div>
</div>
</div>

<div id="outline-container-org8663c2c" class="outline-3">
<h3 id="org8663c2c"><span class="section-number-3">11.8</span> 撤消权限</h3>
<div class="outline-text-3" id="text-11-8">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">REVOKE</span> prvlist <span style="color: #859900;">ON</span> scmname.tabname <span style="color: #859900;">FROM</span> username;
<span style="color: #859900;">REVOKE</span> <span style="color: #859900;">ALL</span> <span style="color: #859900;">PRIVILEGES</span>, <span style="color: #859900;">GRANT</span> <span style="color: #859900;">OPTION</span> <span style="color: #859900;">FROM</span> username;   <span style="color: #586e75; font-style: italic;">-- &#25764;&#38144;&#25152;&#26377;&#26435;&#38480;</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org24ff696" class="outline-3">
<h3 id="org24ff696"><span class="section-number-3">11.9</span> 权限层级</h3>
<div class="outline-text-3" id="text-11-9">
<p>
要使用 GRANT 或 REVOKE，您必须拥有 GRANT OPTION 权限，并且您必须用于您正在授
予或撤销的权限。
</p>
<ul class="org-ul">
<li>全局层级：全局权限适用于一个给定服务器中的所有数据库， <code>mysql.user</code></li>
<li>数据库层级：数据库权限适用于一个给定数据库中的所有目标, <code>mysql.dbname</code> , <code>mysql.host</code></li>
<li>表层级：表权限适用于一个给定表中的所有列, <code>mysql.talbes_priv</code></li>
<li>列层级：列权限适用于一个给定表中的单一列, <code>mysql.columns_priv</code></li>
</ul>

<div class="org-src-container">
<pre class="src src-sql"><span style="color: #586e75; font-style: italic;">-- &#20840;&#23616;&#23618;&#32423;: &#21482;&#25480;&#20104;&#21644;&#25764;&#38144;&#20840;&#23616;&#26435;&#38480;&#12290;</span>
<span style="color: #859900;">GRANT</span>/<span style="color: #859900;">REVOKE</span> <span style="color: #859900;">ALL</span> <span style="color: #859900;">ON</span> *.*;
<span style="color: #586e75; font-style: italic;">-- &#25968;&#25454;&#24211;&#23618;&#32423;: &#21482;&#25480;&#20104;&#21644;&#25764;&#38144;&#25968;&#25454;&#24211;&#26435;&#38480;&#12290;</span>
<span style="color: #859900;">GRANT</span>/<span style="color: #859900;">REVOKE</span> <span style="color: #859900;">ALL</span> <span style="color: #859900;">ON</span> dbname.*;
<span style="color: #586e75; font-style: italic;">-- &#34920;&#23618;&#32423;: &#21482;&#25480;&#20104;&#21644;&#25764;&#38144;&#34920;&#26435;&#38480;&#12290;</span>
<span style="color: #859900;">GRANT</span>/<span style="color: #859900;">REVOKE</span> <span style="color: #859900;">ALL</span> <span style="color: #859900;">ON</span> db_name.tabname;
<span style="color: #586e75; font-style: italic;">-- &#24403;&#20351;&#29992; REVOKE &#26102;&#65292;&#24744;&#24517;&#39035;&#25351;&#23450;&#19982;&#34987;&#25480;&#26435;&#21015;&#30456;&#21516;&#30340;&#21015;&#12290;</span>
<span style="color: #859900;">GRANT</span>/<span style="color: #859900;">REVOKE</span> <span style="color: #859900;">ALL</span> <span style="color: #859900;">ON</span> db_name.tabname(colname1, colname2, ...);
</pre>
</div>
</div>
</div>

<div id="outline-container-orgee73f5d" class="outline-3">
<h3 id="orgee73f5d"><span class="section-number-3">11.10</span> 权限列表</h3>
<div class="outline-text-3" id="text-11-10">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">ALL</span> [<span style="color: #859900;">PRIVILEGES</span>]        <span style="color: #586e75; font-style: italic;">-- &#35774;&#32622;&#38500; GRANT OPTION &#20043;&#22806;&#30340;&#25152;&#26377;&#31616;&#21333;&#26435;&#38480;</span>
<span style="color: #859900;">ALTER</span>                   <span style="color: #586e75; font-style: italic;">-- &#20801;&#35768;&#20351;&#29992; ALTER TABLE</span>
<span style="color: #859900;">ALTER</span> <span style="color: #859900;">ROUTINE</span>           <span style="color: #586e75; font-style: italic;">-- &#26356;&#25913;&#25110;&#21462;&#28040;&#24050;&#23384;&#20648;&#30340;&#23376;&#31243;&#24207;</span>
<span style="color: #859900;">CREATE</span>                  <span style="color: #586e75; font-style: italic;">-- &#20801;&#35768;&#20351;&#29992; CREATE TABLE</span>
<span style="color: #859900;">CREATE</span> <span style="color: #859900;">ROUTINE</span>          <span style="color: #586e75; font-style: italic;">-- &#21019;&#24314;&#24050;&#23384;&#20648;&#30340;&#23376;&#31243;&#24207;</span>
<span style="color: #859900;">CREATE</span> <span style="color: #859900;">TEMPORARY</span> TABLES <span style="color: #586e75; font-style: italic;">-- &#20801;&#35768;&#20351;&#29992; CREATE TEMPORARY TABLE</span>
<span style="color: #859900;">CREATE</span> <span style="color: #6c71c4;">USER</span>             <span style="color: #586e75; font-style: italic;">-- &#20801;&#35768;&#20351;&#29992; CREATE USER, DROP USER, RENAME USER &#21644;</span>
                        <span style="color: #586e75; font-style: italic;">-- REVOKE ALL PRIVILEGES&#12290;</span>
<span style="color: #859900;">CREATE</span> <span style="color: #859900;">VIEW</span>             <span style="color: #586e75; font-style: italic;">-- &#20801;&#35768;&#20351;&#29992; CREATE VIEW</span>
<span style="color: #859900;">DELETE</span>                  <span style="color: #586e75; font-style: italic;">-- &#20801;&#35768;&#20351;&#29992; DELETE</span>
<span style="color: #859900;">DROP</span>                    <span style="color: #586e75; font-style: italic;">-- &#20801;&#35768;&#20351;&#29992; DROP TABLE</span>
<span style="color: #859900;">EXECUTE</span>                 <span style="color: #586e75; font-style: italic;">-- &#20801;&#35768;&#29992;&#25143;&#36816;&#34892;&#24050;&#23384;&#20648;&#30340;&#23376;&#31243;&#24207;</span>
FILE                    <span style="color: #586e75; font-style: italic;">-- &#20801;&#35768;&#20351;&#29992; SELECT...INTO OUTFILE &#21644; LOAD DATA INFILE</span>
INDEX                   <span style="color: #586e75; font-style: italic;">-- &#20801;&#35768;&#20351;&#29992; CREATE INDEX &#21644; DROP INDEX</span>
<span style="color: #859900;">INSERT</span>                  <span style="color: #586e75; font-style: italic;">-- &#20801;&#35768;&#20351;&#29992; INSERT</span>
LOCK TABLES             <span style="color: #586e75; font-style: italic;">-- &#20801;&#35768;&#23545;&#24744;&#25317;&#26377; SELECT &#26435;&#38480;&#30340;&#34920;&#20351;&#29992; LOCK TABLES</span>
PROCESS                 <span style="color: #586e75; font-style: italic;">-- &#20801;&#35768;&#20351;&#29992; SHOW FULL PROCESSLIST</span>
<span style="color: #859900;">REFERENCES</span>              <span style="color: #586e75; font-style: italic;">-- &#26410;&#34987;&#23454;&#26045;</span>
RELOAD                  <span style="color: #586e75; font-style: italic;">-- &#20801;&#35768;&#20351;&#29992; FLUSH</span>
REPLICATION CLIENT      <span style="color: #586e75; font-style: italic;">-- &#20801;&#35768;&#29992;&#25143;&#35810;&#38382;&#20174;&#23646;&#26381;&#21153;&#22120;&#25110;&#20027;&#26381;&#21153;&#22120;&#30340;&#22320;&#22336;</span>
REPLICATION SLAVE       <span style="color: #586e75; font-style: italic;">-- &#29992;&#20110;&#22797;&#21046;&#22411;&#20174;&#23646;&#26381;&#21153;&#22120;&#65288;&#20174;&#20027;&#26381;&#21153;&#22120;&#20013;&#35835;&#21462;&#20108;&#36827;&#21046;&#26085;&#24535;&#20107;&#20214;&#65289;</span>
<span style="color: #859900;">SELECT</span>                  <span style="color: #586e75; font-style: italic;">-- &#20801;&#35768;&#20351;&#29992; SELECT</span>
SHOW DATABASES          <span style="color: #586e75; font-style: italic;">-- &#26174;&#31034;&#25152;&#26377;&#25968;&#25454;&#24211;</span>
SHOW <span style="color: #859900;">VIEW</span>               <span style="color: #586e75; font-style: italic;">-- &#20801;&#35768;&#20351;&#29992; SHOW CREATE VIEW</span>
SHUTDOWN                <span style="color: #586e75; font-style: italic;">-- &#20801;&#35768;&#20351;&#29992; mysqladmin shutdown</span>
SUPER                   <span style="color: #586e75; font-style: italic;">-- &#20801;&#35768;&#20351;&#29992; CHANGE MASTER, KILL, PURGE MASTER LOGS &#21644;</span>
                        <span style="color: #586e75; font-style: italic;">-- SET GLOBAL &#35821;&#21477;&#65292;mysqladmin debug &#21629;&#20196;&#65307;&#20801;&#35768;&#24744;&#36830;&#25509;</span>
                        <span style="color: #586e75; font-style: italic;">-- &#65288;&#19968;&#27425;&#65289;&#65292;&#21363;&#20351;&#24050;&#36798;&#21040; max_connections&#12290;</span>
<span style="color: #859900;">UPDATE</span>                  <span style="color: #586e75; font-style: italic;">-- &#20801;&#35768;&#20351;&#29992; UPDATE</span>
<span style="color: #859900;">USAGE</span>                   <span style="color: #586e75; font-style: italic;">-- "&#26080;&#26435;&#38480;" &#30340;&#21516;&#20041;&#35789;</span>
<span style="color: #859900;">GRANT</span> <span style="color: #859900;">OPTION</span>            <span style="color: #586e75; font-style: italic;">-- &#20801;&#35768;&#25480;&#20104;&#26435;&#38480;</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf48a3da" class="outline-2">
<h2 id="orgf48a3da"><span class="section-number-2">12</span> 表维护</h2>
<div class="outline-text-2" id="text-12">
</div>
<div id="outline-container-org26bdd3c" class="outline-3">
<h3 id="org26bdd3c"><span class="section-number-3">12.1</span> 分析和存储表的关键字分布</h3>
<div class="outline-text-3" id="text-12-1">
<div class="org-src-container">
<pre class="src src-sql">ANALYZE [<span style="color: #859900;">LOCAL</span> | NO_WRITE_TO_BINLOG] <span style="color: #859900;">TABLE</span> &#34920;&#21517; ...
</pre>
</div>
</div>
</div>

<div id="outline-container-org7782bae" class="outline-3">
<h3 id="org7782bae"><span class="section-number-3">12.2</span> 检查一个或多个表是否有错误</h3>
<div class="outline-text-3" id="text-12-2">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">CHECK</span> <span style="color: #859900;">TABLE</span> tabname [, tabname] ... [<span style="color: #859900;">option</span>] ...
</pre>
</div>
<ul class="org-ul">
<li>option = {QUICK | FAST | MEDIUM | EXTENDED | CHANGED}</li>
</ul>
</div>
</div>

<div id="outline-container-orge9e89fe" class="outline-3">
<h3 id="orge9e89fe"><span class="section-number-3">12.3</span> 整理数据文件的碎片</h3>
<div class="outline-text-3" id="text-12-3">
<div class="org-src-container">
<pre class="src src-sql">OPTIMIZE [<span style="color: #859900;">LOCAL</span> | NO_WRITE_TO_BINLOG] <span style="color: #859900;">TABLE</span> tabname [, tabname] ...
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org505188c" class="outline-2">
<h2 id="org505188c"><span class="section-number-2">13</span> 导入/导出数据</h2>
<div class="outline-text-2" id="text-13">
</div>
<div id="outline-container-org8772405" class="outline-3">
<h3 id="org8772405"><span class="section-number-3">13.1</span> Select 方法导入/导出 CSV 文件</h3>
<div class="outline-text-3" id="text-13-1">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #586e75; font-style: italic;">-- &#23548;&#20986;&#34920;&#25968;&#25454;</span>
<span style="color: #859900;">SELECT</span> * <span style="color: #859900;">INTO</span> OUTFILE filename [export_option] <span style="color: #859900;">FROM</span> tabname;

<span style="color: #586e75; font-style: italic;">-- &#23548;&#20837;&#25968;&#25454;</span>
LOAD <span style="color: #859900;">DATA</span> [<span style="color: #859900;">LOCAL</span>] INFILE filename [REPLACE|<span style="color: #859900;">IGNORE</span>] <span style="color: #859900;">INTO</span> <span style="color: #859900;">TABLE</span> tabname [import_option];
</pre>
</div>
<ul class="org-ul">
<li>生成的数据默认的分隔符是制表符</li>
<li>LOCAL 未指定，则数据文件必须在服务器上</li>
<li>REPLACE 和 IGNORE 关键词控制对现有的唯一键记录的重复的处理</li>
<li>选项 <code>export_option</code> / <code>import_option</code>
<ul class="org-ul">
<li>FIELDS 控制字段格式, 默认为： <code>FIELDS TERMINATED BY '\T' ENCLOSED BY '' ESCAPED BY '\\'</code>
<ul class="org-ul">
<li>终止: TERMINATED BY 'string'</li>
<li>包裹: ENCLOSED BY 'char'</li>
<li>转义: ESCAPED BY 'char'</li>
</ul></li>
<li>LINES 控制行格式，默认为： <code>LINES TERMINATED BY '\N'</code>
<ul class="org-ul">
<li>起始: STARTING BY 'string'</li>
<li>终止: TERMINATED BY 'string'</li>
</ul></li>
</ul></li>
</ul>

<p>
下面是一个导出的示例
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">select</span> a, b, a+b
  <span style="color: #859900;">into</span> outfile <span style="color: #2aa198;">'/tmp/result.csv'</span>
       fields terminated <span style="color: #859900;">by</span> <span style="color: #2aa198;">','</span>
       optionally enclosed <span style="color: #859900;">by</span> <span style="color: #2aa198;">'"'</span>
       lines terminated <span style="color: #859900;">by</span> <span style="color: #2aa198;">'\n'</span>
  <span style="color: #859900;">from</span> test_table;
</pre>
</div>
</div>
</div>

<div id="outline-container-org75bdb31" class="outline-3">
<h3 id="org75bdb31"><span class="section-number-3">13.2</span> 使用 mysqldump 工具</h3>
<div class="outline-text-3" id="text-13-2">
</div>
<div id="outline-container-org1cf8e1e" class="outline-4">
<h4 id="org1cf8e1e"><span class="section-number-4">13.2.1</span> 备份数据</h4>
<div class="outline-text-4" id="text-13-2-1">
<ol class="org-ol">
<li><code>--single-transaction</code> 选型在备份时尽量添加，可以保证数据的一致性</li>
<li>如果远程导入的本地需要指定使用 <code>-h</code> 选项指定主机名</li>
<li>本地数据库可以使用 <code>-S</code> 指定 socket 文件</li>
<li>导出后生成一个 SQL 脚本</li>
</ol>

<p>
操作多个数据库
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #586e75; font-style: italic;"># </span><span style="color: #586e75; font-style: italic;">&#23548;&#20986;&#25152;&#26377;&#25968;&#25454;&#24211;</span>
mysqldump --single-transaction -u user -p -A &gt; /tmp/all-databases.sql
mysqldump --single-transaction -u user -p -S /tmp/mysql.sock -A &gt; /tmp/all-databases.sql
mysqldump --single-transaction -u user -p --all-databases &gt; /tmp/all-databases.sql
<span style="color: #586e75; font-style: italic;"># </span><span style="color: #586e75; font-style: italic;">&#23548;&#20986;&#22810;&#25968;&#25454;&#24211;&#65292;&#25351;&#23450;&#24453;&#23548;&#20986;&#25968;&#25454;&#24211;&#30340;&#21517;&#31216;&#65292;&#20363;&#22914;&#23548;&#20986; db01 &#21644; db02</span>
mysqldump --single-transaction -u user -p -B db01 db02 &gt; /tmp/db01-and-db02.sql
</pre>
</div>

<p>
操作单个数据库
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #586e75; font-style: italic;"># </span><span style="color: #586e75; font-style: italic;">&#23548;&#20986; db01 &#25968;&#25454;&#24211;&#30340;&#25152;&#26377;&#34920;&#21450;&#25968;&#25454;</span>
mysqldump --single-transaction -u user -p db01 &gt; /tmp/db01.sql
<span style="color: #586e75; font-style: italic;"># </span><span style="color: #586e75; font-style: italic;">&#23548;&#20986;&#19968;&#24352;&#25110;&#22810;&#24352;&#34920;&#65292;&#20363;&#22914;&#65306;&#23548;&#20986; db01 &#25968;&#25454;&#24211;&#30340; tb01 &#21644; tb02 &#20004;&#24352;&#25968;&#25454;&#24211;&#34920;</span>
mysqldump --single-transaction -u user -p db01 tb01 tb02 &gt; /tmp/tbs-of-db01.sql
<span style="color: #586e75; font-style: italic;"># </span><span style="color: #586e75; font-style: italic;">&#23548;&#20986;&#25968;&#25454;&#24211;&#26102;&#19981;&#23548;&#20986;&#25968;&#25454;&#65292;&#20165;&#20165;&#23548;&#20986;&#34920;&#32467;&#26500;</span>
mysqldump --single-transaction -u user -p -d db01 &gt; /tmp/db01-schema.sql
</pre>
</div>
</div>
</div>

<div id="outline-container-orge157e5a" class="outline-4">
<h4 id="orge157e5a"><span class="section-number-4">13.2.2</span> 导入数据</h4>
<div class="outline-text-4" id="text-13-2-2">
<p>
导入数据时先建用户和数据库
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #586e75; font-style: italic;">-- &#26032;&#24314;&#25968;&#25454;&#24211;</span>
<span style="color: #859900;">CREATE</span> DATABASE dbname <span style="color: #859900;">DEFAULT</span> <span style="color: #268bd2;">CHARACTER</span> <span style="color: #859900;">SET</span> utf8;
<span style="color: #586e75; font-style: italic;">-- &#26032;&#24314;&#29992;&#25143;&#24182;&#28155;&#21152;&#26435;&#38480;</span>
<span style="color: #859900;">GRANT</span> <span style="color: #859900;">ALL</span> <span style="color: #859900;">PRIVILEGES</span> <span style="color: #859900;">ON</span> dbname.* <span style="color: #859900;">TO</span> <span style="color: #2aa198;">'username'</span>@<span style="color: #2aa198;">'%'</span> IDENTIFIED <span style="color: #859900;">BY</span> <span style="color: #2aa198;">'password'</span>;
<span style="color: #586e75; font-style: italic;">-- mysql &#38656;&#35201;&#26174;&#31034;&#21047;&#26032;&#26435;&#38480;</span>
FLUSH <span style="color: #859900;">PRIVILEGES</span>;
</pre>
</div>

<p>
在 MySQL 命令行里面使用 source 导入数据
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">source</span> <span style="color: #859900;">out</span>.<span style="color: #859900;">sql</span>
</pre>
</div>

<p>
在 shell 可以使用非交互式命令导入
</p>
<div class="org-src-container">
<pre class="src src-sh">mysql -u user -p pass dbname &lt; out.sql
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-orgc9e1d4a" class="outline-2">
<h2 id="orgc9e1d4a"><span class="section-number-2">14</span> 内置函数</h2>
<div class="outline-text-2" id="text-14">
</div>
<div id="outline-container-orgbdc707b" class="outline-3">
<h3 id="orgbdc707b"><span class="section-number-3">14.1</span> 数值函数</h3>
<div class="outline-text-3" id="text-14-1">
<ul class="org-ul">
<li><code>abs(x)</code> : 绝对值 abs(-10.9) = 10</li>
<li><code>format(x, d)</code> : 格式化千分位数值 format(1234567.456, 2) = 1,234,567.46</li>
<li><code>ceil(x)</code> : 向上取整 ceil(10.1) = 11</li>
<li><code>floor(x)</code> : 向下取整 floor (10.1) = 10</li>
<li><code>round(x)</code> : 四舍五入去整</li>
<li><code>mod(m, n)</code> : m%n m mod n 求余 10%3=1</li>
<li><code>pi()</code> : 获得圆周率</li>
<li><code>pow(m, n)</code> : m<sup>n</sup></li>
<li><code>sqrt(x)</code> : 算术平方根</li>
<li><code>rand()</code> : 随机数</li>
<li><code>truncate(x, d)</code> : 截取 d 位小数</li>
</ul>
</div>
</div>

<div id="outline-container-org54b191c" class="outline-3">
<h3 id="org54b191c"><span class="section-number-3">14.2</span> 时间日期函数</h3>
<div class="outline-text-3" id="text-14-2">
<ul class="org-ul">
<li><code>now(), current_timestamp()</code> : 当前日期时间</li>
<li><code>current_date()</code> : 当前日期</li>
<li><code>current_time()</code> : 当前时间</li>
<li><code>date('yyyy-mm-dd hh:ii:ss')</code> : 获取日期部分</li>
<li><code>time('yyyy-mm-dd hh:ii:ss')</code> : 获取时间部分</li>
<li><code>date_format('yyyy-mm-dd hh:ii:ss', '%d %y %a %d %m %b %j')</code> : 格式化时间</li>
<li><code>unix_timestamp()</code> : 获得 unix 时间戳</li>
<li><code>from_unixtime()</code> : 从时间戳获得时间</li>
</ul>
</div>
</div>

<div id="outline-container-orgea21617" class="outline-3">
<h3 id="orgea21617"><span class="section-number-3">14.3</span> 字符串函数</h3>
<div class="outline-text-3" id="text-14-3">
<ul class="org-ul">
<li><code>length(string)</code> : string 长度，字节</li>
<li><code>char_length(string)</code> : string 的字符个数</li>
<li><code>substring(str, position [,length])</code> : 从 str 的 position 开始,取 length 个字符</li>
<li><code>replace(str ,search_str ,replace_str)</code> : 在 str 中用 <code>replace_str</code> 替换 <code>search_str</code></li>
<li><code>instr(string ,substring)</code> : 返回 substring 首次在 string 中出现的位置</li>
<li><code>concat(string [,...])</code> : 连接字串</li>
<li><code>charset(str)</code> : 返回字串字符集</li>
<li><code>lcase(string)</code> : 转换成小写</li>
<li><code>left(string, length)</code> : 从 string2 中的左边起取 length 个字符</li>
<li><code>load_file(file_name)</code> : 从文件读取内容</li>
<li><code>locate(substring, string [,start_position])</code> : 同 instr,但可指定开始位置</li>
<li><code>lpad(string, length, pad)</code> : 重复用 pad 加在 string 开头,直到字串长度为 length</li>
<li><code>ltrim(string)</code> : 去除前端空格</li>
<li><code>repeat(string, count)</code> : 重复 count 次</li>
<li><code>rpad(string, length, pad)</code> : 在 str 后用 pad 补充,直到长度为 length</li>
<li><code>rtrim(string)</code> : 去除后端空格</li>
<li><code>strcmp(string1 ,string2)</code> : 逐字符比较两字串大小</li>
</ul>
</div>
</div>

<div id="outline-container-orgbd9263c" class="outline-3">
<h3 id="orgbd9263c"><span class="section-number-3">14.4</span> 流程函数</h3>
<div class="outline-text-3" id="text-14-4">
<ul class="org-ul">
<li><code>case when [condition] then result [when [condition] then result ...] [else result] end</code> : 多分支</li>
<li><code>if(expr1,expr2,expr3)</code> 双分支。</li>
</ul>
</div>
</div>

<div id="outline-container-orgfe4cb2f" class="outline-3">
<h3 id="orgfe4cb2f"><span class="section-number-3">14.5</span> 聚合函数</h3>
<div class="outline-text-3" id="text-14-5">
<ul class="org-ul">
<li><code>count()</code></li>
<li><code>sum()</code></li>
<li><code>max()</code></li>
<li><code>min()</code></li>
<li><code>avg()</code></li>
<li><code>group_concat()</code></li>
</ul>
</div>
</div>

<div id="outline-container-org6b08807" class="outline-3">
<h3 id="org6b08807"><span class="section-number-3">14.6</span> 其他常用函数</h3>
<div class="outline-text-3" id="text-14-6">
<ul class="org-ul">
<li><code>md5()</code></li>
<li><code>default()</code></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org5ef51c4" class="outline-2">
<h2 id="org5ef51c4"><span class="section-number-2">15</span> 常见问题</h2>
<div class="outline-text-2" id="text-15">
</div>
<div id="outline-container-orga390257" class="outline-3">
<h3 id="orga390257"><span class="section-number-3">15.1</span> 配置客户端提示符</h3>
<div class="outline-text-3" id="text-15-1">
<p>
添加如下环境变量
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #6c71c4;">export</span> <span style="color: #6c71c4;">MYSQL_PS1</span>=<span style="color: #2aa198;">"\u@\h [\d]&gt; "</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org42993a3" class="outline-3">
<h3 id="org42993a3"><span class="section-number-3">15.2</span> 开启通用日志，慢日志和 binlog</h3>
<div class="outline-text-3" id="text-15-2">
<p>
在 my.cnf 添加如下启动选项
</p>
<div class="org-src-container">
<pre class="src src-conf">[<span style="color: #268bd2;">mysqld</span>]
<span style="color: #6c71c4;">log-bin</span>             = binlog
<span style="color: #6c71c4;">server-id</span>           = 1

<span style="color: #6c71c4;">log-output</span>          = TABLE
<span style="color: #6c71c4;">general-log</span>         = 1
<span style="color: #586e75; font-style: italic;">#</span><span style="color: #586e75; font-style: italic;">general-log-file    = /usr/local/var/mysql/general.log</span>
<span style="color: #6c71c4;">slow-query-log</span>      = 1
<span style="color: #586e75; font-style: italic;">#</span><span style="color: #586e75; font-style: italic;">slow-query-log-file = /usr/local/var/mysql/slow.log</span>
<span style="color: #6c71c4;">long-query-time</span>     = 1
</pre>
</div>

<p>
需要注意的是 <code>log-output</code> 指定 TABLE 可以将通用日志和慢日志直接输出到系统表中
对应 <code>mysql.general_log</code> 和 <code>mysql.slow_log</code>
</p>
</div>
</div>

<div id="outline-container-org264aca9" class="outline-3">
<h3 id="org264aca9"><span class="section-number-3">15.3</span> 创建用户和数据库</h3>
<div class="outline-text-3" id="text-15-3">
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">create</span> database test01 <span style="color: #859900;">default</span> <span style="color: #268bd2;">character</span> <span style="color: #859900;">set</span> utf8mb4 <span style="color: #859900;">collate</span> utf8mb4_general_ci;

<span style="color: #859900;">create</span> <span style="color: #6c71c4;">user</span> <span style="color: #2aa198;">'user01'</span>@<span style="color: #2aa198;">'%'</span> identified <span style="color: #859900;">by</span> <span style="color: #2aa198;">'user01'</span>;
<span style="color: #859900;">grant</span> <span style="color: #859900;">all</span> <span style="color: #859900;">privileges</span> <span style="color: #859900;">on</span> user01.* <span style="color: #859900;">to</span> <span style="color: #2aa198;">'test01'</span>@<span style="color: #2aa198;">'%'</span>;
flush <span style="color: #859900;">privileges</span>;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd17209d" class="outline-3">
<h3 id="orgd17209d"><span class="section-number-3">15.4</span> 修改用户密码</h3>
<div class="outline-text-3" id="text-15-4">
<p>
修改自身的密码
</p>
<div class="org-src-container">
<pre class="src src-sql">use mysql;
<span style="color: #859900;">set</span> password = password(<span style="color: #2aa198;">'root'</span>);
<span style="color: #859900;">update</span> <span style="color: #6c71c4;">user</span> <span style="color: #859900;">set</span> <span style="color: #859900;">host</span> = <span style="color: #2aa198;">'%'</span> <span style="color: #859900;">where</span> <span style="color: #6c71c4;">user</span> = <span style="color: #2aa198;">'root'</span>;
flush <span style="color: #859900;">privileges</span>;
</pre>
</div>

<p>
修改其它用户密码
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #859900;">set</span> password <span style="color: #859900;">for</span> <span style="color: #2aa198;">'test01'</span>@<span style="color: #2aa198;">'%'</span> = password(<span style="color: #2aa198;">'1234'</span>);
flush <span style="color: #859900;">privileges</span>;
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org8a5e8ca" class="outline-2">
<h2 id="org8a5e8ca"><span class="section-number-2">16</span> 参考连接</h2>
<div class="outline-text-2" id="text-16">
<ol class="org-ol">
<li><a href="https://github.com/jaywcjlove/mysql-tutorial/blob/master/21-minutes-MySQL-basic-entry.md">https://github.com/jaywcjlove/mysql-tutorial/blob/master/21-minutes-MySQL-basic-entry.md</a></li>
<li><a href="https://github.com/XD-DENG/SQL-exercise">https://github.com/XD-DENG/SQL-exercise</a></li>
</ol>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Last Updated 2021-07-02 Fri 23:34. Created by Jinghui Hu at 2019-07-05 Fri 11:04.</p>
</div>
</body>
</html>

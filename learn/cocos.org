#+TITLE: cocos 游戏相关工程
#+AUTHOR: Jinghui Hu
#+EMAIL: hujinghui@buaa.edu.cn
#+DATE: <2025-12-01 Mon>
#+STARTUP: overview num indent
#+OPTIONS: ^:nil


* cocos2d-x 环境
** 基础工具
1. cocos2d-x-3.17.2 | [[https://www.cocos.com/cocos2dx-download][link]]
   - v4 还在开发中， v3 用户比较多
   - 开发文档 | [[https://docs.cocos.com/cocos2d-x/manual/zh/basic_concepts/][link]]
2. Python2 | 这里不要使用 Python3 会报错
   #+BEGIN_SRC sh
     # 进入源码目录后
     python setup.py
   #+END_SRC
3. vs2022
   - cocos2d-x 是 vs2015 构建的，这里首次启动时需要迁移一下项目

** 创建项目
#+BEGIN_SRC sh
  cocos new HelloGame -p io.github.jeanhwea.hello -l cpp
#+END_SRC

#+BEGIN_EXAMPLE
  (py27) D:\temp\demo> cocos new -p io.github.jeanhwea.hello -l cpp hello
  > 拷贝模板到 D:\temp\demo\hello
  > 拷贝 cocos2d-x ...
  > 替换文件名中的工程名称，'HelloCpp' 替换为 'hello'。
  > 替换文件中的工程名称，'HelloCpp' 替换为 'hello'。
  > 替换工程的包名，'org.cocos2dx.hellocpp' 替换为 'io.github.jeanhwea.hello'。
  > 替换 Mac 工程的 Bundle ID，'org.cocos2dx.hellocpp' 替换为 'io.github.jeanhwea.hello'。
  > 替换 iOS 工程的 Bundle ID，'org.cocos2dx.hellocpp' 替换为 'io.github.jeanhwea.hello'。
  (py27) D:\temp\demo> dir
   驱动器 D 中的卷是 DATA
   卷的序列号是 5645-DEB3

   D:\temp\demo 的目录

  2025/12/01  16:53    <DIR>          .
  2025/12/01  16:15    <DIR>          ..
  2025/12/01  16:53    <DIR>          hello
                 0 个文件              0 字节
                 3 个目录 277,488,177,152 可用字节

  (py27) D:\temp\demo>
#+END_EXAMPLE

** Windows 生成项目
cocos2d-x v3 项目创建报错 GWL_WNDPROC 的解决方法
#+BEGIN_SRC sh
  cmake -B build -G"Visual Studio 17 2022" -A win32
#+END_SRC

执行日志
#+BEGIN_EXAMPLE
  (py27) D:\code\redinf\MyGame\build> cmake .. -G"Visual Studio 17 2022" -A win32
  CMake Deprecation Warning at CMakeLists.txt:26 (cmake_minimum_required):
    Compatibility with CMake < 3.10 will be removed from a future version of
    CMake.

    Update the VERSION argument <min> value.  Or, use the <min>...<max> syntax
    to tell CMake that the project requires at least <min> but has been updated
    to work with policies introduced by <max> or earlier.


  -- Selecting Windows SDK version 10.0.26100.0 to target Windows 10.0.26200.
  -- The C compiler identification is MSVC 19.44.35217.0
  -- The CXX compiler identification is MSVC 19.44.35217.0
  -- Detecting C compiler ABI info
  -- Detecting C compiler ABI info - done
  -- Check for working C compiler: C:/Program Files/Microsoft Visual Studio/2022/Community/VC/Tools/MSVC/14.44.35207/bin/Hostx64/x86/cl.exe - skipped
  -- Detecting C compile features
  -- Detecting C compile features - done
  -- Detecting CXX compiler ABI info
  -- Detecting CXX compiler ABI info - done
  -- Check for working CXX compiler: C:/Program Files/Microsoft Visual Studio/2022/Community/VC/Tools/MSVC/14.44.35207/bin/Hostx64/x86/cl.exe - skipped
  -- Detecting CXX compile features
  -- Detecting CXX compile features - done
  -- PROJECT_NAME:MyGame
  -- PROJECT_SOURCE_DIR:D:/code/redinf/MyGame
  -- COCOS2DX_ROOT_PATH:D:/code/redinf/MyGame/cocos2d
  -- CMAKE_MODULE_PATH:D:/code/redinf/MyGame/cocos2d/cmake/Modules/
  -- PROJECT_BINARY_DIR:D:/code/redinf/MyGame/build
  -- ENGINE_BINARY_PATH:D:/code/redinf/MyGame/build/engine
  -- CMAKE_GENERATOR: Visual Studio 17 2022
  -- using Windows MSVC generate cocos2d-x project, MSVC_VERSION:1944
  CMake Deprecation Warning at cocos2d/external/CMakeLists.txt:1 (cmake_minimum_required):
    Compatibility with CMake < 3.10 will be removed from a future version of
    CMake.

    Update the VERSION argument <min> value.  Or, use the <min>...<max> syntax
    to tell CMake that the project requires at least <min> but has been updated
    to work with policies introduced by <max> or earlier.

  ... 此处省略一堆输出

  -- Generating done (0.2s)
  -- Build files have been written to: D:/code/redinf/MyGame/build

  (py27) D:\code\redinf\MyGame\build>
#+END_EXAMPLE

构建项目
#+BEGIN_SRC sh
  cmake --build build --config Release
#+END_SRC

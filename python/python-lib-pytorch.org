#+TITLE: PyTorch
#+AUTHOR: Jinghui Hu
#+EMAIL: hujinghui@buaa.edu.cn
#+DATE: <2020-10-12 Mon 10:48:59>
#+HTML_LINK_UP: ../readme.html
#+HTML_LINK_HOME: ../index.html
#+SETUPFILE: ~/.emacs.d/site-lisp/org-html-themes/setup/theme-readtheorg-local.setup
#+TAGS: pytorch torch python cnn


* PyTorch
  PyTorch 和 Numpy 的数组和相似，PyTorch 的数据类型大多数是叫 Tensor，并且 Tensor
  可以在 GPU 上进行计算，用于提高计算效率

  #+BEGIN_SRC python :session cpython :exports both :results none
    import torch
    import numpy as np
  #+END_SRC

* 基础运算

  初始化 Tensor
  #+BEGIN_SRC python :session cpython :exports both :results output
    x0 = torch.zeros((2, 3))
    print(x0)
    x1 = torch.ones((3, 2))
    print(x1)
  #+END_SRC

  #+RESULTS:
  : tensor([[0., 0., 0.],
  :         [0., 0., 0.]])
  : tensor([[1., 1.],
  :         [1., 1.],
  :         [1., 1.]])

  Tensor 和 Numpy 互转
  #+BEGIN_SRC python :session cpython :exports both :results output pp
    t1 = torch.randn((2, 3)) # normal distribution with shape (2,3)
    a1 = t1.numpy()
    print(t1)
    print(a1)

    a2 = np.random.normal(0, 0.01, 10)
    t2 = torch.from_numpy(a2)
    print(a2)
    print(t2)
  #+END_SRC

  #+RESULTS:
  : tensor([[ 2.0561,  1.1593,  2.7883],
  :         [-0.7887,  0.3536,  1.7694]])
  : [[ 2.0561314   1.1592966   2.7883365 ]
  :  [-0.7886873   0.35360292  1.7694149 ]]
  : [-0.00119581 -0.0058083  -0.02654656  0.00712973 -0.01919779 -0.01425222
  :   0.0085908   0.00619372 -0.00130839 -0.0010277 ]
  : tensor([-0.0012, -0.0058, -0.0265,  0.0071, -0.0192, -0.0143,  0.0086,  0.0062,
  :         -0.0013, -0.0010], dtype=torch.float64)


* 附录
  安装 PyTorch 之前最好是配合 Anaconda3 发行版一起安装，安装好 Anaconda 过后直接
  使用下面命令安装
  #+BEGIN_SRC sh
    conda install pytorch torchvision -c pytorch
  #+END_SRC

  也可以使用 pip 安装对应的 wheel 包
  #+BEGIN_SRC sh
    pip3 install torch torchvision
  #+END_SRC

* 参考链接
  1. [[https://pytorch.org/][PyTorch]]
  2. [[https://pytorch.org/docs/stable/index.html][PyTorch Doc]]
  3. [[https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/][Anaconda Download]]
  4. [[https://orgmode.org/worg/org-contrib/babel/languages/ob-doc-python.html][org-mode python]]
